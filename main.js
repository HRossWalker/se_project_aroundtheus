!function(){"use strict";var t=class{constructor(t,e,s,i,r){this._name=t.name,this._link=t.link,this._id=t._id,this._likeStatus=t.isLiked,this._cardSelector=e,this._handleImageClick=s,this._handleDeleteClick=i,this._handleLikeDislike=r}_setEventListeners(){this._cardImageElement.addEventListener("click",(()=>this._handleImageClick(this))),this._likeIcon.addEventListener("click",(()=>this._handleLikeDislike(this._likeStatus,this._id))),this._trashIcon.addEventListener("click",(()=>{this._handleDeleteClick(this._id)}))}_handleLikeIcon(){this._likeIcon.classList.toggle("card__like-button_active")}handleDeleteCard(){this._cardElement.remove()}_getTemplate(){return this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0),this._cardElement}getView(){return this._element=this._getTemplate(),this._cardTitleElement=this._cardElement.querySelector(".card__title"),this._cardTitleElement.textContent=this._name,this._cardImageElement=this._cardElement.querySelector(".card__image"),this._cardImageElement.src=this._link,this._cardImageElement.alt=this._name,this._likeIcon=this._cardElement.querySelector(".card__like-button"),this._likeStatus&&this._likeIcon.classList.add("card__like-button_active"),this._trashIcon=this._cardElement.querySelector(".card__trash-button"),this._deleteModal=document.querySelector("modal__delete-modal_active"),this._setEventListeners(),this._element}},e=class{constructor(t,e){this._formSelector=t.formSelector,this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass,this._formEl=e,this._inputList=[...this._formEl.querySelectorAll(this._inputSelector)],this._submitButton=this._formEl.querySelector(this._submitButtonSelector)}_setEventListeners(){this._inputList.forEach((t=>{t.addEventListener("input",(()=>{this._inputEl=t,this._checkInputValidity(t),this._toggleButtonState()}))}))}_showInputError(){this._errorMessageEl=document.querySelector(`#${this._inputEl.id}-error`),this._errorMessageEl.textContent=this._inputEl.validationMessage,this._inputEl.classList.add(this._inputErrorClass),this._errorMessageEl.classList.add(this._errorClass)}_checkInputValidity(){if(!this._inputEl.validity.valid)return this._showInputError();this._hideInputError()}_hideInputError(){this._errorMessageEl=document.querySelector(`#${this._inputEl.id}-error`),this._errorMessageEl.textContent="",this._inputEl.classList.remove(this._inputErrorClass),this._errorMessageEl.classList.remove(this._errorClass)}_toggleButtonState(){this._hasInvalidInput(this._inputList)?this._enableButton(this._inactiveButtonClass):this._disableButton(this._inactiveButtonClass)}_hasInvalidInput(){return!this._inputList.every((t=>t.validity.valid))}_enableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_disableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}enableValidation(){this._formEl.addEventListener("submit",(t=>{t.preventDefault()})),this._setEventListeners()}resetValidation(){this._toggleButtonState(),this._inputList.forEach((t=>{this._inputEl=t,this._hideInputError()}))}};const s=document.querySelector("#profile-edit-button"),i=document.querySelector("#modal-name-input"),r=document.querySelector("#modal-about-input"),a=document.querySelector(".profile__avatar-edit"),n=document.querySelector("#card-add-button"),o=document.querySelector(".cards__list"),l=document.querySelector("#modal-del-btn");var c=class{constructor(t){let{popupSelector:e}=t;this._modalEl=document.querySelector(e)}open(){this._modalEl.classList.add("modal_opened"),document.addEventListener("keyup",this._handleEsc)}close(){this._modalEl.classList.remove("modal_opened"),document.removeEventListener("keyup",this._handleEsc)}_handleEsc=t=>{"Escape"===t.key&&this.close()};setEventListeners(){this._modalEl.addEventListener("mousedown",(t=>{t.target.classList.contains("modal_opened")&&this.close(),t.target.classList.contains("modal__close")&&this.close()}))}},h=class extends c{constructor(t,e){super({popupSelector:t}),this._popupForm=this._modalEl.querySelector(".modal__form"),this._submitButton=this._modalEl.querySelector(".modal__save-button"),this._handleFormSubmit=e,this._list=[...this._popupForm.querySelectorAll(".modal__input")]}setSave(){this._submitButton.textContent="Save"}close(){this._popupForm.reset(),super.close()}setLoading(t){t&&(this._submitButton.textContent="Saving...")}_getInputValues(){const t={};return this._list.forEach((e=>{t[e.name]=e.value})),t}setEventListeners(){this._popupForm.addEventListener("submit",(()=>{this._handleFormSubmit(this._getInputValues())})),super.setEventListeners()}},d=class{constructor(t){this._name=document.querySelector(".profile__name"),this._name.textContent=t.name,this._about=document.querySelector(".profile__about"),this._about.textContent=t.about,this._avatar=document.querySelector(".profile__image"),this._avatar.src=t.avatar}setUserAvatar(t){this._avatar.src=t}setUserInfo(t){let{name:e,about:s}=t;this._name.textContent=e,this._about.textContent=s}},u=class{constructor(t,e){let{data:s,renderer:i}=t;this._items=s,this._renderer=i,this._container=e}renderItems(){this._items.forEach((t=>{this._renderer(t)}))}addItem(t){this._container.prepend(t)}};const _={};let m,p;var E;E={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__save-button",inactiveButtonClass:"modal__button-disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__input-error_visible"},Array.from(document.querySelectorAll(E.formSelector)).forEach((t=>{const s=new e(E,t),i=t.getAttribute("name");_[i]=s,s.enableValidation()}));const v=new class{constructor(t){this._baseUrl=t.baseUrl,this._auth=t.authorization,this._id}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:{authorization:`${this._auth}`}}).then(this._checkResponse)}getUserData(){return fetch(`${this._baseUrl}/users/me`,{method:"GET",headers:{authorization:`${this._auth}`,"Content-Type":"application/json"}}).then(this._checkResponse)}updateUserData(t){let{name:e,about:s}=t;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:{authorization:`${this._auth}`,"Content-Type":"application/json"},body:JSON.stringify({name:`${e}`,about:`${s}`})}).then(this._checkResponse)}updateAvatar(t){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:{authorization:`${this._auth}`,"Content-Type":"application/json"},body:JSON.stringify({avatar:t})}).then(this._checkResponse)}getCards(t){return fetch(`${this._baseUrl}/cards/${t}`,{method:"GET",headers:{authorization:`${this._auth}`}}).then(this._checkResponse)}createCard(t){let{name:e,link:s}=t;return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:{authorization:`${this._auth}`,"Content-Type":"application/json"},body:JSON.stringify({name:`${e}`,link:`${s}`})}).then(this._checkResponse)}deleteCard(t){return fetch(`${this._baseUrl}/cards/${t}`,{method:"DELETE",headers:{authorization:`${this._auth}`,"Content-Type":"application/json"}}).then(this._checkResponse)}likeCard(t){return fetch(`${this._baseUrl}/cards/${t}/likes`,{method:"PUT",headers:{authorization:`${this._auth}`,"Content-Type":"application/json"},body:JSON.stringify({isLiked:!0})}).then(this._checkResponse)}disLikeCard(t){return fetch(`${this._baseUrl}/cards/${t}/likes`,{method:"DELETE",headers:{authorization:`${this._auth}`,"Content-Type":"application/json"}}).then(this._checkResponse)}_checkResponse(t){return t.ok?t.json():Promise.reject(`Error: ${t.status}`)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",authorization:"7dcd9a93-149c-4e56-87db-9285c9177a9e"});v.getUserData().then((t=>{p=new d(t)})).catch((t=>console.error(`${t} Profile info may be incorrect`))),v.getInitialCards().then((t=>{m=new u({data:t,renderer:t=>{const e=b(t);m.addItem(e)}},o),m.renderItems()})).catch((t=>console.error(`${t} Cards may be missing`)));const b=e=>{const s=new t(e,"#card-template",(()=>{S.open(e)}),(()=>{y.open(s)}),((t,e)=>{t?v.disLikeCard(e).then((()=>s._handleLikeIcon())).catch((t=>console.error(`${t}, Failed to dislike card`))):v.likeCard(e).then((()=>s._handleLikeIcon())).catch((t=>console.error(`${t}, Failed to like card`)))}));return s.getView()},S=new class extends c{constructor(t){super({popupSelector:t}),this._popupImage=document.querySelector(".modal__picture-view"),this._popupTitle=document.querySelector(".modal__picture-heading")}open(t){let{name:e,link:s}=t;this._popupImage.src=s,this._popupImage.alt=e,this._popupTitle.textContent=e,super.open()}}("#card-picture-modal");S.setEventListeners();const k=new h("#profile-edit-modal",(function(t){k.setLoading(!0),v.updateUserData(t).then((()=>{p.setUserInfo(t),k.close()})).catch((t=>console.error(`${t}, Failed to update Profile Info`))).finally((()=>{k.setLoading(!1),k.setSave()}))}));k.setEventListeners();const L=new h("#card-add-modal",(function(t){L.setLoading(!0),v.createCard(t).then((t=>{const e=b(t);m.addItem(e),L.close()})).catch((t=>console.error(`${t}, Failed to add Card`))).finally((()=>{L.setLoading(!1),L.setSave()}))}));L.setEventListeners();const y=new class extends c{constructor(t,e){super({popupSelector:t}),this._handleDeleteConfirmation=e}open(t){super.open(),this._cardId=t._id,this._card=t}setEventListeners(){l.addEventListener("click",(()=>{this._handleDeleteConfirmation(this._card,this._cardId)})),super.setEventListeners()}}("#modal-delete",(function(t,e){v.deleteCard(e).then((()=>{t.handleDeleteCard(),y.close()})).catch((t=>console.error(`${t}, Failed to delete card`)))}));y.setEventListeners();const C=new h("#modal-avatar",(function(t){C.setLoading(!0),v.updateAvatar(t.link).then((()=>{p.setUserAvatar(t.link),C.close()})).catch((t=>console.error(`${t}, Failed to update Avatar`))).finally((()=>{C.setLoading(!1),C.setSave()}))}));C.setEventListeners(),s.addEventListener("click",(()=>{_.profileForm.resetValidation(),v.getUserData().then((t=>{i.value=t.name,r.value=t.about,k.open()})).catch((t=>console.error(`${t} Profile data may be incorrect`)))})),n.addEventListener("click",(()=>{_.addCardForm.resetValidation(),L.open()})),a.addEventListener("click",(()=>{_.avatarUpdate.resetValidation(),C.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QnVFLEVBQWEvRixNQUFNLElBRXBCaUYsT0FBT0MsR0FBUUMsUUFBUUMsTUFBTyxHQUFFRixvQ0FBcUMsSUFHMUV4RixFQUFjakUsaUJBQWlCLFNBQVMsS0FDdEM4RyxFQUE0QixZQUFFbEQsa0JBQzlCNkcsRUFBYWxHLE1BQU0sSUFHckJQLEVBQW1CaEUsaUJBQWlCLFNBQVMsS0FDM0M4RyxFQUE2QixhQUFFbEQsa0JBQy9Cb0gsRUFBWXpHLE1BQU0sRyIsInNvdXJjZXMiOlsid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvdXRpbHMvdXRpbHMuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBDb25maXJtYXRpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgYXBpIH0gZnJvbSBcIi4uL3BhZ2VzL2luZGV4LmpzXCI7XHJcbmltcG9ydCB7IGRlbGV0ZUNvbmZpcm1Qb3B1cCB9IGZyb20gXCIuLi9wYWdlcy9pbmRleC5qc1wiO1xyXG5cclxuY2xhc3MgQ2FyZCB7XHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBkYXRhLFxyXG4gICAgY2FyZFNlbGVjdG9yLFxyXG4gICAgaGFuZGxlSW1hZ2VDbGljayxcclxuICAgIGhhbmRsZURlbGV0ZUNsaWNrLFxyXG4gICAgaGFuZGxlTGlrZURpc2xpa2VDbGlja1xyXG4gICkge1xyXG4gICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZTtcclxuICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XHJcbiAgICB0aGlzLl9pZCA9IGRhdGEuX2lkO1xyXG4gICAgdGhpcy5fbGlrZVN0YXR1cyA9IGRhdGEuaXNMaWtlZDtcclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xyXG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sgPSBoYW5kbGVEZWxldGVDbGljaztcclxuICAgIHRoaXMuX2hhbmRsZUxpa2VEaXNsaWtlID0gaGFuZGxlTGlrZURpc2xpa2VDbGljaztcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2NhcmRJbWFnZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XHJcbiAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sodGhpcylcclxuICAgICk7XHJcblxyXG4gICAgdGhpcy5fbGlrZUljb24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XHJcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2VEaXNsaWtlKHRoaXMuX2xpa2VTdGF0dXMsIHRoaXMuX2lkKVxyXG4gICAgKTtcclxuXHJcbiAgICB0aGlzLl90cmFzaEljb24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sodGhpcy5faWQpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlTGlrZUljb24oKSB7XHJcbiAgICB0aGlzLl9saWtlSWNvbi5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gIH1cclxuXHJcbiAgaGFuZGxlRGVsZXRlQ2FyZCgpIHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgLy8gdGhpcy5fY2FyZEVsZW1lbnQgPSBudWxsO1xyXG4gIH1cclxuXHJcbiAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXHJcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxyXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG5cclxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcclxuICB9XHJcblxyXG4gIGdldFZpZXcoKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcclxuICAgIHRoaXMuX2NhcmRUaXRsZUVsZW1lbnQgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpO1xyXG4gICAgdGhpcy5fY2FyZFRpdGxlRWxlbWVudC50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbGVtZW50ID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcclxuICAgIHRoaXMuX2NhcmRJbWFnZUVsZW1lbnQuc3JjID0gdGhpcy5fbGluaztcclxuICAgIHRoaXMuX2NhcmRJbWFnZUVsZW1lbnQuYWx0ID0gdGhpcy5fbmFtZTtcclxuICAgIHRoaXMuX2xpa2VJY29uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcclxuICAgIGlmICh0aGlzLl9saWtlU3RhdHVzKVxyXG4gICAgICB0aGlzLl9saWtlSWNvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgdGhpcy5fdHJhc2hJY29uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190cmFzaC1idXR0b25cIik7XHJcbiAgICB0aGlzLl9kZWxldGVNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJtb2RhbF9fZGVsZXRlLW1vZGFsX2FjdGl2ZVwiKTtcclxuXHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgQ2FyZDtcclxuIiwiY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbCkge1xyXG4gICAgdGhpcy5fZm9ybVNlbGVjdG9yID0gc2V0dGluZ3MuZm9ybVNlbGVjdG9yO1xyXG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IHNldHRpbmdzLmlucHV0U2VsZWN0b3I7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xyXG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IHNldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3M7XHJcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBzZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gc2V0dGluZ3MuZXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Zvcm1FbCA9IGZvcm1FbDtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IFsuLi50aGlzLl9mb3JtRWwucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKV07XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtRWwucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xyXG4gICAgICBpbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5faW5wdXRFbCA9IGlucHV0RWw7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfc2hvd0lucHV0RXJyb3IoKSB7XHJcbiAgICB0aGlzLl9lcnJvck1lc3NhZ2VFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke3RoaXMuX2lucHV0RWwuaWR9LWVycm9yYCk7XHJcbiAgICB0aGlzLl9lcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IHRoaXMuX2lucHV0RWwudmFsaWRhdGlvbk1lc3NhZ2U7XHJcbiAgICB0aGlzLl9pbnB1dEVsLmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIHRoaXMuX2Vycm9yTWVzc2FnZUVsLmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KCkge1xyXG4gICAgaWYgKCF0aGlzLl9pbnB1dEVsLnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9zaG93SW5wdXRFcnJvcigpO1xyXG4gICAgfVxyXG4gICAgdGhpcy5faGlkZUlucHV0RXJyb3IoKTtcclxuICB9XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvcigpIHtcclxuICAgIHRoaXMuX2Vycm9yTWVzc2FnZUVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgIyR7dGhpcy5faW5wdXRFbC5pZH0tZXJyb3JgKTtcclxuICAgIHRoaXMuX2Vycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gXCJcIjtcclxuICAgIHRoaXMuX2lucHV0RWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcclxuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQodGhpcy5faW5wdXRMaXN0KSkge1xyXG4gICAgICB0aGlzLl9lbmFibGVCdXR0b24odGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHRoaXMuX2Rpc2FibGVCdXR0b24odGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfaGFzSW52YWxpZElucHV0KCkge1xyXG4gICAgcmV0dXJuICF0aGlzLl9pbnB1dExpc3QuZXZlcnkoKGlucHV0RWwpID0+IGlucHV0RWwudmFsaWRpdHkudmFsaWQpO1xyXG4gIH1cclxuXHJcbiAgX2VuYWJsZUJ1dHRvbigpIHtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcclxuICB9XHJcblxyXG4gIF9kaXNhYmxlQnV0dG9uKCkge1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcclxuICB9XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9mb3JtRWwuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxuICByZXNldFZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG5cclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsKSA9PiB7XHJcbiAgICAgIHRoaXMuX2lucHV0RWwgPSBpbnB1dEVsO1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcigpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBGb3JtVmFsaWRhdG9yO1xyXG4iLCIvLyBDQVJEIERBVEFcclxuXHJcbi8vIGV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXHJcbi8vICAge1xyXG4vLyAgICAgbmFtZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcclxuLy8gICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC95b3NlbWl0ZS5qcGdcIixcclxuLy8gICB9LFxyXG4vLyAgIHtcclxuLy8gICAgIG5hbWU6IFwiTGFrZSBMb3Vpc2VcIixcclxuLy8gICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWtlLWxvdWlzZS5qcGdcIixcclxuLy8gICB9LFxyXG4vLyAgIHtcclxuLy8gICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcclxuLy8gICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9iYWxkLW1vdW50YWlucy5qcGdcIixcclxuLy8gICB9LFxyXG4vLyAgIHtcclxuLy8gICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxyXG4vLyAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhdGVtYXIuanBnXCIsXHJcbi8vICAgfSxcclxuLy8gICB7XHJcbi8vICAgICBuYW1lOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxyXG4vLyAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3Zhbm9pc2UuanBnXCIsXHJcbi8vICAgfSxcclxuLy8gICB7XHJcbi8vICAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXHJcbi8vICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFnby5qcGdcIixcclxuLy8gICB9LFxyXG4vLyBdO1xyXG5cclxuLy8gUFJPRklMRSBFTEVNRU5UU1xyXG5cclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtYnV0dG9uXCIpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZU5hbWVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWwtbmFtZS1pbnB1dFwiKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVBYm91dElucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1hYm91dC1pbnB1dFwiKTtcclxuZXhwb3J0IGNvbnN0IGF2YXRhclVwZGF0ZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIucHJvZmlsZV9fYXZhdGFyLWVkaXRcIlxyXG4pO1xyXG5cclxuLy9DQVJEIEVMRU1FTlRTXHJcblxyXG5leHBvcnQgY29uc3QgY2FyZEFkZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC1hZGQtYnV0dG9uXCIpO1xyXG5leHBvcnQgY29uc3QgY2FyZExpc3RFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcclxuZXhwb3J0IGNvbnN0IGNhcmREZWxldGVDb25maXJtQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1kZWwtYnRuXCIpO1xyXG5cclxuLy8gU0VMRUNUT1JTXHJcblxyXG5leHBvcnQgY29uc3QgY29uZmlnID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX3NhdmUtYnV0dG9uXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fYnV0dG9uLWRpc2FibGVkXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXHJcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXQtZXJyb3JfdmlzaWJsZVwiLFxyXG59O1xyXG4iLCJjbGFzcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yIH0pIHtcclxuICAgIHRoaXMuX21vZGFsRWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgb3BlbigpIHtcclxuICAgIHRoaXMuX21vZGFsRWwuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCB0aGlzLl9oYW5kbGVFc2MpO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9tb2RhbEVsLmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgdGhpcy5faGFuZGxlRXNjKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVFc2MgPSAoZSkgPT4ge1xyXG4gICAgaWYgKGUua2V5ID09PSBcIkVzY2FwZVwiKSB0aGlzLmNsb3NlKCk7XHJcbiAgfTtcclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9tb2RhbEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGUpID0+IHtcclxuICAgICAgaWYgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX29wZW5lZFwiKSkge1xyXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgfVxyXG4gICAgICBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfX2Nsb3NlXCIpKSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFBvcHVwO1xyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xyXG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fbW9kYWxFbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fbW9kYWxFbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zYXZlLWJ1dHRvblwiKTtcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xyXG4gICAgdGhpcy5fbGlzdCA9IFsuLi50aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9faW5wdXRcIildO1xyXG4gIH1cclxuXHJcbiAgc2V0U2F2ZSgpIHtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2ZVwiO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcclxuICAgIHN1cGVyLmNsb3NlKCk7XHJcbiAgfVxyXG5cclxuICBzZXRMb2FkaW5nKGxvYWRpbmcpIHtcclxuICAgIGlmIChsb2FkaW5nKSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICBjb25zdCBpbnB1dERhdGEgPSB7fTtcclxuICAgIHRoaXMuX2xpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgaW5wdXREYXRhW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gaW5wdXREYXRhO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICB9KTtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhGb3JtO1xyXG4iLCJjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IodXNlckRhdGEpIHtcclxuICAgIHRoaXMuX25hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX25hbWVcIik7XHJcbiAgICB0aGlzLl9uYW1lLnRleHRDb250ZW50ID0gdXNlckRhdGEubmFtZTtcclxuICAgIHRoaXMuX2Fib3V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hYm91dFwiKTtcclxuICAgIHRoaXMuX2Fib3V0LnRleHRDb250ZW50ID0gdXNlckRhdGEuYWJvdXQ7XHJcbiAgICB0aGlzLl9hdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2ltYWdlXCIpO1xyXG4gICAgdGhpcy5fYXZhdGFyLnNyYyA9IHVzZXJEYXRhLmF2YXRhcjtcclxuICB9XHJcblxyXG4gIHNldFVzZXJBdmF0YXIobGluaykge1xyXG4gICAgdGhpcy5fYXZhdGFyLnNyYyA9IGxpbms7XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyh7IG5hbWUsIGFib3V0IH0pIHtcclxuICAgIHRoaXMuX25hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgdGhpcy5fYWJvdXQudGV4dENvbnRlbnQgPSBhYm91dDtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFVzZXJJbmZvO1xyXG4iLCJjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3Rvcih7IGRhdGEsIHJlbmRlcmVyIH0sIGNvbnRhaW5lcikge1xyXG4gICAgdGhpcy5faXRlbXMgPSBkYXRhO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGNvbnRhaW5lcjtcclxuICB9XHJcblxyXG4gIHJlbmRlckl0ZW1zKCkge1xyXG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFNlY3Rpb247XHJcbiIsImltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgUG9wdXBDb25maXJtYXRpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBDb25maXJtYXRpb24uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2VzIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xyXG5pbXBvcnQgXCIuLi9wYWdlcy9pbmRleC5jc3NcIjtcclxuaW1wb3J0IHtcclxuICBjYXJkQWRkQnV0dG9uLFxyXG4gIGF2YXRhclVwZGF0ZUJ1dHRvbixcclxuICBwcm9maWxlRWRpdEJ1dHRvbixcclxuICBwcm9maWxlTmFtZUlucHV0LFxyXG4gIHByb2ZpbGVBYm91dElucHV0LFxyXG4gIGNhcmRMaXN0RWxlbWVudCxcclxuICBjb25maWcsXHJcbn0gZnJvbSBcIi4uL3V0aWxzL3V0aWxzLmpzXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcclxuXHJcbmNvbnN0IGZvcm1WYWxpZGF0b3JzID0ge307XHJcblxyXG5jb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5mb3JtU2VsZWN0b3IpKTtcclxuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xyXG4gICAgY29uc3QgdmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnLCBmb3JtRWxlbWVudCk7XHJcbiAgICBjb25zdCBmb3JtTmFtZSA9IGZvcm1FbGVtZW50LmdldEF0dHJpYnV0ZShcIm5hbWVcIik7XHJcbiAgICBmb3JtVmFsaWRhdG9yc1tmb3JtTmFtZV0gPSB2YWxpZGF0b3I7XHJcbiAgICB2YWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuZW5hYmxlVmFsaWRhdGlvbihjb25maWcpO1xyXG5cclxuLy9WQVJcclxuXHJcbmxldCBjYXJkU2VjdGlvbjtcclxubGV0IGluaXRpYWxVc2VyRGF0YTtcclxuXHJcbi8vQVBJXHJcblxyXG5leHBvcnQgY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxyXG4gIGF1dGhvcml6YXRpb246IFwiN2RjZDlhOTMtMTQ5Yy00ZTU2LTg3ZGItOTI4NWM5MTc3YTllXCIsXHJcbn0pO1xyXG5cclxuYXBpXHJcbiAgLmdldFVzZXJEYXRhKClcclxuICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgaW5pdGlhbFVzZXJEYXRhID0gbmV3IFVzZXJJbmZvKGRhdGEpO1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoYCR7ZXJyfSBQcm9maWxlIGluZm8gbWF5IGJlIGluY29ycmVjdGApKTtcclxuXHJcbmFwaVxyXG4gIC5nZXRJbml0aWFsQ2FyZHMoKVxyXG4gIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxyXG4gICAgICB7XHJcbiAgICAgICAgZGF0YTogZGF0YSxcclxuICAgICAgICByZW5kZXJlcjogKGRhdGEpID0+IHtcclxuICAgICAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChkYXRhKTtcclxuICAgICAgICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW0oY2FyZEVsZW1lbnQpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgIH0sXHJcbiAgICAgIGNhcmRMaXN0RWxlbWVudFxyXG4gICAgKTtcclxuICAgIGNhcmRTZWN0aW9uLnJlbmRlckl0ZW1zKCk7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihgJHtlcnJ9IENhcmRzIG1heSBiZSBtaXNzaW5nYCkpO1xyXG5cclxuY29uc3QgY3JlYXRlQ2FyZCA9IChjYXJkSXRlbSkgPT4ge1xyXG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcclxuICAgIGNhcmRJdGVtLFxyXG4gICAgXCIjY2FyZC10ZW1wbGF0ZVwiLFxyXG4gICAgKCkgPT4ge1xyXG4gICAgICBpbWdQb3B1cC5vcGVuKGNhcmRJdGVtKTtcclxuICAgIH0sXHJcbiAgICAoKSA9PiB7XHJcbiAgICAgIGRlbGV0ZUNvbmZpcm1Qb3B1cC5vcGVuKGNhcmQpO1xyXG4gICAgfSxcclxuXHJcbiAgICAobGlrZVN0YXR1cywgaWQpID0+IHtcclxuICAgICAgaWYgKCFsaWtlU3RhdHVzKSB7XHJcbiAgICAgICAgYXBpXHJcbiAgICAgICAgICAubGlrZUNhcmQoaWQpXHJcbiAgICAgICAgICAudGhlbigoKSA9PiBjYXJkLl9oYW5kbGVMaWtlSWNvbigpKVxyXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoYCR7ZXJyfSwgRmFpbGVkIHRvIGxpa2UgY2FyZGApKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBhcGlcclxuICAgICAgICAgIC5kaXNMaWtlQ2FyZChpZClcclxuICAgICAgICAgIC50aGVuKCgpID0+IGNhcmQuX2hhbmRsZUxpa2VJY29uKCkpXHJcbiAgICAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihgJHtlcnJ9LCBGYWlsZWQgdG8gZGlzbGlrZSBjYXJkYCkpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgKTtcclxuICByZXR1cm4gY2FyZC5nZXRWaWV3KCk7XHJcbn07XHJcblxyXG4vL1BvcHVwc1xyXG5cclxuY29uc3QgaW1nUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2VzKFwiI2NhcmQtcGljdHVyZS1tb2RhbFwiKTtcclxuaW1nUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmNvbnN0IHByb2ZpbGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiLFxyXG4gIGhhbmRsZVByb2ZpbGVVcGRhdGVcclxuKTtcclxucHJvZmlsZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCBuZXdDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNjYXJkLWFkZC1tb2RhbFwiLCBoYW5kbGVBZGRDYXJkKTtcclxubmV3Q2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5leHBvcnQgY29uc3QgZGVsZXRlQ29uZmlybVBvcHVwID0gbmV3IFBvcHVwQ29uZmlybWF0aW9uKFxyXG4gIFwiI21vZGFsLWRlbGV0ZVwiLFxyXG4gIGhhbmRsZURlbGV0ZUNvbmZpcm1hdGlvblxyXG4pO1xyXG5kZWxldGVDb25maXJtUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmNvbnN0IGF2YXRhclBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjbW9kYWwtYXZhdGFyXCIsIGhhbmRsZVVwZGF0ZUF2YXRhcik7XHJcbmF2YXRhclBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vL0hBTkRMRVNcclxuXHJcbi8vIGZ1bmN0aW9uIGhhbmRsZVN1Ym1pdChyZXF1ZXN0LCBwb3B1cEluc3RhbmNlLCBsb2FkaW5nVGV4dCA9IFwiU2F2aW5nLi4uXCIpIHtcclxuLy8gICBwb3B1cEluc3RhbmNlLnJlbmRlckxvYWRpbmcodHJ1ZSwgbG9hZGluZ1RleHQpO1xyXG4vLyAgIHJlcXVlc3QoKVxyXG4vLyAgICAgLnRoZW4oKCkgPT4ge1xyXG4vLyAgICAgICBwb3B1cEluc3RhbmNlLmNsb3NlKCk7XHJcbi8vICAgICB9KVxyXG4vLyAgICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXHJcbi8vICAgICAuZmluYWxseSgoKSA9PiB7XHJcbi8vICAgICAgIHBvcHVwSW5zdGFuY2UucmVuZGVyTG9hZGluZyhmYWxzZSk7XHJcbi8vICAgICB9KTtcclxuLy8gfVxyXG5cclxuLy8gZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQoaW5wdXRWYWx1ZXMpIHtcclxuLy8gICAgICAgICB3ZSBjcmVhdGUgYSBmdW5jdGlvbiB0aGF0IHJldHVybnMgYSBwcm9taXNlXHJcbi8vICAgZnVuY3Rpb24gbWFrZVJlcXVlc3QoKSB7XHJcbi8vICAgICAgICBgcmV0dXJuYCBsZXRzIHVzIHVzZSBhIHByb21pc2UgY2hhaW4gYHRoZW4sIGNhdGNoLCBmaW5hbGx5YCBpbnNpZGUgYGhhbmRsZVN1Ym1pdGBcclxuLy8gICAgIHJldHVybiBhcGkuZWRpdFByb2ZpbGUoaW5wdXRWYWx1ZXMpLnRoZW4oKHVzZXJEYXRhKSA9PiB7XHJcbi8vICAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHVzZXJEYXRhKVxyXG4vLyAgICAgfSk7XHJcbi8vICAgfVxyXG4vLyAgICAgICAgIEhlcmUgd2UgY2FsbCB0aGUgZnVuY3Rpb24gcGFzc2luZyB0aGUgcmVxdWVzdCwgcG9wdXAgaW5zdGFuY2UgYW5kIGlmIHdlIG5lZWQgc29tZSBvdGhlciBsb2FkaW5nIHRleHQgd2UgY2FuIHBhc3MgaXQgYXMgdGhlIDNyZCBhcmd1bWVudFxyXG4vLyAgIGhhbmRsZVN1Ym1pdChtYWtlUmVxdWVzdCwgcHJvZmlsZVBvcHVwKTtcclxuLy8gfVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlQ29uZmlybWF0aW9uKGNhcmQsIGlkKSB7XHJcbiAgYXBpXHJcbiAgICAuZGVsZXRlQ2FyZChpZClcclxuICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgY2FyZC5oYW5kbGVEZWxldGVDYXJkKCk7XHJcbiAgICAgIGRlbGV0ZUNvbmZpcm1Qb3B1cC5jbG9zZSgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKGAke2Vycn0sIEZhaWxlZCB0byBkZWxldGUgY2FyZGApKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZVVwZGF0ZSh1c2VyRGF0YSkge1xyXG4gIHByb2ZpbGVQb3B1cC5zZXRMb2FkaW5nKHRydWUpO1xyXG4gIGFwaVxyXG4gICAgLnVwZGF0ZVVzZXJEYXRhKHVzZXJEYXRhKVxyXG4gICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICBpbml0aWFsVXNlckRhdGEuc2V0VXNlckluZm8odXNlckRhdGEpO1xyXG4gICAgICBwcm9maWxlUG9wdXAuY2xvc2UoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihgJHtlcnJ9LCBGYWlsZWQgdG8gdXBkYXRlIFByb2ZpbGUgSW5mb2ApKVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBwcm9maWxlUG9wdXAuc2V0TG9hZGluZyhmYWxzZSk7XHJcbiAgICAgIHByb2ZpbGVQb3B1cC5zZXRTYXZlKCk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlQWRkQ2FyZChjYXJkRGF0YSkge1xyXG4gIG5ld0NhcmRQb3B1cC5zZXRMb2FkaW5nKHRydWUpO1xyXG4gIGFwaVxyXG4gICAgLmNyZWF0ZUNhcmQoY2FyZERhdGEpXHJcbiAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICBjb25zdCBjYXJkRm9ybUVsZW1lbnQgPSBjcmVhdGVDYXJkKGRhdGEpO1xyXG4gICAgICBjYXJkU2VjdGlvbi5hZGRJdGVtKGNhcmRGb3JtRWxlbWVudCk7XHJcbiAgICAgIG5ld0NhcmRQb3B1cC5jbG9zZSgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKGAke2Vycn0sIEZhaWxlZCB0byBhZGQgQ2FyZGApKVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBuZXdDYXJkUG9wdXAuc2V0TG9hZGluZyhmYWxzZSk7XHJcbiAgICAgIG5ld0NhcmRQb3B1cC5zZXRTYXZlKCk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlVXBkYXRlQXZhdGFyKGlucHV0KSB7XHJcbiAgYXZhdGFyUG9wdXAuc2V0TG9hZGluZyh0cnVlKTtcclxuICBhcGlcclxuICAgIC51cGRhdGVBdmF0YXIoaW5wdXQubGluaylcclxuICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgaW5pdGlhbFVzZXJEYXRhLnNldFVzZXJBdmF0YXIoaW5wdXQubGluayk7XHJcbiAgICAgIGF2YXRhclBvcHVwLmNsb3NlKCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoYCR7ZXJyfSwgRmFpbGVkIHRvIHVwZGF0ZSBBdmF0YXJgKSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgYXZhdGFyUG9wdXAuc2V0TG9hZGluZyhmYWxzZSk7XHJcbiAgICAgIGF2YXRhclBvcHVwLnNldFNhdmUoKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG4vL0VWRU5UIExJU1RFTkVSXHJcblxyXG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGZvcm1WYWxpZGF0b3JzW1wicHJvZmlsZUZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgYXBpXHJcbiAgICAuZ2V0VXNlckRhdGEoKVxyXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgcHJvZmlsZU5hbWVJbnB1dC52YWx1ZSA9IGRhdGEubmFtZTtcclxuICAgICAgcHJvZmlsZUFib3V0SW5wdXQudmFsdWUgPSBkYXRhLmFib3V0O1xyXG4gICAgICBwcm9maWxlUG9wdXAub3BlbigpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKGAke2Vycn0gUHJvZmlsZSBkYXRhIG1heSBiZSBpbmNvcnJlY3RgKSk7XHJcbn0pO1xyXG5cclxuY2FyZEFkZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGZvcm1WYWxpZGF0b3JzW1wiYWRkQ2FyZEZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgbmV3Q2FyZFBvcHVwLm9wZW4oKTtcclxufSk7XHJcblxyXG5hdmF0YXJVcGRhdGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBmb3JtVmFsaWRhdG9yc1tcImF2YXRhclVwZGF0ZVwiXS5yZXNldFZhbGlkYXRpb24oKTtcclxuICBhdmF0YXJQb3B1cC5vcGVuKCk7XHJcbn0pO1xyXG4iLCJjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBvcHRpb25zLmJhc2VVcmw7XHJcbiAgICB0aGlzLl9hdXRoID0gb3B0aW9ucy5hdXRob3JpemF0aW9uO1xyXG4gICAgdGhpcy5faWQ7XHJcbiAgfVxyXG5cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiBgJHt0aGlzLl9hdXRofWAsXHJcbiAgICAgIH0sXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckRhdGEoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJHRVRcIixcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IGAke3RoaXMuX2F1dGh9YCxcclxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICAgICAgfSxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVVc2VyRGF0YSh7IG5hbWUsIGFib3V0IH0pIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiBgJHt0aGlzLl9hdXRofWAsXHJcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgIH0sXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgbmFtZTogYCR7bmFtZX1gLCBhYm91dDogYCR7YWJvdXR9YCB9KSxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVBdmF0YXIobGluaykge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiBgJHt0aGlzLl9hdXRofWAsXHJcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgIH0sXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgYXZhdGFyOiBsaW5rIH0pLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGdldENhcmRzKGlkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtpZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogXCJHRVRcIixcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IGAke3RoaXMuX2F1dGh9YCxcclxuICAgICAgfSxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBjcmVhdGVDYXJkKHsgbmFtZSwgbGluayB9KSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiBgJHt0aGlzLl9hdXRofWAsXHJcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgIH0sXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgbmFtZTogYCR7bmFtZX1gLCBsaW5rOiBgJHtsaW5rfWAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZChpZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7aWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiBgJHt0aGlzLl9hdXRofWAsXHJcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgIH0sXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgbGlrZUNhcmQoaWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2lkfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogYCR7dGhpcy5fYXV0aH1gLFxyXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gICAgICB9LFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGlzTGlrZWQ6IHRydWUgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgZGlzTGlrZUNhcmQoaWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2lkfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogYCR7dGhpcy5fYXV0aH1gLFxyXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gICAgICB9LFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIF9jaGVja1Jlc3BvbnNlKHJlcykge1xyXG4gICAgaWYgKHJlcy5vaykge1xyXG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgIH1cclxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICB9XHJcblxyXG4gIC8vIF9yZXF1ZXN0KHVybCwgb3B0aW9ucykge1xyXG4gIC8vICAgcmV0dXJuIGZldGNoKHVybCwgb3B0aW9ucykudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICAvLyB9XHJcbiAgLy8qKioqKiogVHJpZWQgdGhpcyBtZXRob2QgYW5kIGl0IG1hZGUgdGhlIGVhY2ggQXBpIGdldFVzZXJEYXRhKCkgbm90IG9wZXJhYmxlLCBhbmQgc2VlbXMgdG8gdGhpbmsgaXRzIG5vdCBhIHByb21pc2UuLi5cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgQXBpO1xyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcclxuICAgIHRoaXMuX3BvcHVwSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19waWN0dXJlLXZpZXdcIik7XHJcbiAgICB0aGlzLl9wb3B1cFRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fcGljdHVyZS1oZWFkaW5nXCIpO1xyXG4gIH1cclxuXHJcbiAgb3Blbih7IG5hbWUsIGxpbmsgfSkge1xyXG4gICAgdGhpcy5fcG9wdXBJbWFnZS5zcmMgPSBsaW5rO1xyXG4gICAgdGhpcy5fcG9wdXBJbWFnZS5hbHQgPSBuYW1lO1xyXG4gICAgdGhpcy5fcG9wdXBUaXRsZS50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhJbWFnZTtcclxuIiwiaW1wb3J0IHsgY2FyZERlbGV0ZUNvbmZpcm1CdXR0b24gfSBmcm9tIFwiLi4vdXRpbHMvdXRpbHMuanNcIjtcclxuaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5jbGFzcyBQb3B1cENvbmZpcm1hdGlvbiBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVEZWxldGVDb25maXJtYXRpb24pIHtcclxuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcclxuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNvbmZpcm1hdGlvbiA9IGhhbmRsZURlbGV0ZUNvbmZpcm1hdGlvbjtcclxuICB9XHJcblxyXG4gIG9wZW4oY2FyZCkge1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gICAgdGhpcy5fY2FyZElkID0gY2FyZC5faWQ7XHJcbiAgICB0aGlzLl9jYXJkID0gY2FyZDtcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgY2FyZERlbGV0ZUNvbmZpcm1CdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ29uZmlybWF0aW9uKHRoaXMuX2NhcmQsIHRoaXMuX2NhcmRJZCk7XHJcbiAgICB9KTtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQb3B1cENvbmZpcm1hdGlvbjtcclxuIl0sIm5hbWVzIjpbImNvbnN0cnVjdG9yIiwiZGF0YSIsImNhcmRTZWxlY3RvciIsImhhbmRsZUltYWdlQ2xpY2siLCJoYW5kbGVEZWxldGVDbGljayIsImhhbmRsZUxpa2VEaXNsaWtlQ2xpY2siLCJ0aGlzIiwiX25hbWUiLCJuYW1lIiwiX2xpbmsiLCJsaW5rIiwiX2lkIiwiX2xpa2VTdGF0dXMiLCJpc0xpa2VkIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZURlbGV0ZUNsaWNrIiwiX2hhbmRsZUxpa2VEaXNsaWtlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX2NhcmRJbWFnZUVsZW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiX2xpa2VJY29uIiwiX3RyYXNoSWNvbiIsIl9oYW5kbGVMaWtlSWNvbiIsImNsYXNzTGlzdCIsInRvZ2dsZSIsImhhbmRsZURlbGV0ZUNhcmQiLCJfY2FyZEVsZW1lbnQiLCJyZW1vdmUiLCJfZ2V0VGVtcGxhdGUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiZ2V0VmlldyIsIl9lbGVtZW50IiwiX2NhcmRUaXRsZUVsZW1lbnQiLCJ0ZXh0Q29udGVudCIsInNyYyIsImFsdCIsImFkZCIsIl9kZWxldGVNb2RhbCIsInNldHRpbmdzIiwiZm9ybUVsIiwiX2Zvcm1TZWxlY3RvciIsImZvcm1TZWxlY3RvciIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9mb3JtRWwiLCJfaW5wdXRMaXN0IiwicXVlcnlTZWxlY3RvckFsbCIsIl9zdWJtaXRCdXR0b24iLCJmb3JFYWNoIiwiaW5wdXRFbCIsIl9pbnB1dEVsIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsIl90b2dnbGVCdXR0b25TdGF0ZSIsIl9zaG93SW5wdXRFcnJvciIsIl9lcnJvck1lc3NhZ2VFbCIsImlkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hpZGVJbnB1dEVycm9yIiwiX2hhc0ludmFsaWRJbnB1dCIsIl9lbmFibGVCdXR0b24iLCJfZGlzYWJsZUJ1dHRvbiIsImV2ZXJ5IiwiZGlzYWJsZWQiLCJlbmFibGVWYWxpZGF0aW9uIiwiZSIsInByZXZlbnREZWZhdWx0IiwicmVzZXRWYWxpZGF0aW9uIiwicHJvZmlsZUVkaXRCdXR0b24iLCJwcm9maWxlTmFtZUlucHV0IiwicHJvZmlsZUFib3V0SW5wdXQiLCJhdmF0YXJVcGRhdGVCdXR0b24iLCJjYXJkQWRkQnV0dG9uIiwiY2FyZExpc3RFbGVtZW50IiwiY2FyZERlbGV0ZUNvbmZpcm1CdXR0b24iLCJfcmVmIiwicG9wdXBTZWxlY3RvciIsIl9tb2RhbEVsIiwib3BlbiIsIl9oYW5kbGVFc2MiLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJrZXkiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsImNvbnRhaW5zIiwiUG9wdXAiLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfcG9wdXBGb3JtIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfbGlzdCIsInNldFNhdmUiLCJyZXNldCIsInNldExvYWRpbmciLCJsb2FkaW5nIiwiX2dldElucHV0VmFsdWVzIiwiaW5wdXREYXRhIiwiaW5wdXQiLCJ2YWx1ZSIsInVzZXJEYXRhIiwiX2Fib3V0IiwiYWJvdXQiLCJfYXZhdGFyIiwiYXZhdGFyIiwic2V0VXNlckF2YXRhciIsInNldFVzZXJJbmZvIiwiY29udGFpbmVyIiwicmVuZGVyZXIiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJpdGVtIiwiYWRkSXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwiZm9ybVZhbGlkYXRvcnMiLCJjYXJkU2VjdGlvbiIsImluaXRpYWxVc2VyRGF0YSIsImNvbmZpZyIsIkFycmF5IiwiZnJvbSIsImZvcm1FbGVtZW50IiwidmFsaWRhdG9yIiwiRm9ybVZhbGlkYXRvciIsImZvcm1OYW1lIiwiZ2V0QXR0cmlidXRlIiwiYXBpIiwib3B0aW9ucyIsIl9iYXNlVXJsIiwiYmFzZVVybCIsIl9hdXRoIiwiYXV0aG9yaXphdGlvbiIsImdldEluaXRpYWxDYXJkcyIsImZldGNoIiwiaGVhZGVycyIsInRoZW4iLCJfY2hlY2tSZXNwb25zZSIsImdldFVzZXJEYXRhIiwibWV0aG9kIiwidXBkYXRlVXNlckRhdGEiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsInVwZGF0ZUF2YXRhciIsImdldENhcmRzIiwiY3JlYXRlQ2FyZCIsIl9yZWYyIiwiZGVsZXRlQ2FyZCIsImxpa2VDYXJkIiwiZGlzTGlrZUNhcmQiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiVXNlckluZm8iLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsIlNlY3Rpb24iLCJjYXJkRWxlbWVudCIsImNhcmRJdGVtIiwiY2FyZCIsIkNhcmQiLCJpbWdQb3B1cCIsImRlbGV0ZUNvbmZpcm1Qb3B1cCIsImxpa2VTdGF0dXMiLCJfcG9wdXBJbWFnZSIsIl9wb3B1cFRpdGxlIiwicHJvZmlsZVBvcHVwIiwiUG9wdXBXaXRoRm9ybSIsImZpbmFsbHkiLCJuZXdDYXJkUG9wdXAiLCJjYXJkRGF0YSIsImNhcmRGb3JtRWxlbWVudCIsImhhbmRsZURlbGV0ZUNvbmZpcm1hdGlvbiIsIl9oYW5kbGVEZWxldGVDb25maXJtYXRpb24iLCJfY2FyZElkIiwiX2NhcmQiLCJhdmF0YXJQb3B1cCJdLCJzb3VyY2VSb290IjoiIn0=