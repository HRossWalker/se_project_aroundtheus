!function(){"use strict";var t={d:function(e,s){for(var i in s)t.o(s,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:s[i]})},o:function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}};t.d({},{h:function(){return v},A:function(){return I}});var e=class{constructor(t,e,s,i,r){this._name=t.name,this._link=t.link,this._id=t._id,this._likeStatus=t.isLiked,this._cardSelector=e,this._handleImageClick=s,this._handleLikeDisLike=r,this._handleDeleteClick=i}_setEventListeners(){this._cardImageElement.addEventListener("click",(()=>this._handleImageClick(this))),this._likeIcon.addEventListener("click",(()=>this._handleLikeIcon())),this._trashIcon.addEventListener("click",(()=>{this._handleDeleteClick(this._id)}))}_handleLikeIcon(){this._likeIcon.classList.toggle("card__like-button_active"),this._likeStatus||v.likeCard(this._id),v.disLikeCard(this._id)}_handleDeleteConfirm(t){I.open(t)}handleDeleteCard(t){this._cardElement.remove(),v.deleteCard(t)}_getTemplate(){return this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0),this._cardElement}getView(){return this._element=this._getTemplate(),this._cardTitleElement=this._cardElement.querySelector(".card__title"),this._cardTitleElement.textContent=this._name,this._cardImageElement=this._cardElement.querySelector(".card__image"),this._cardImageElement.src=this._link,this._cardImageElement.alt=this._name,this._likeIcon=this._cardElement.querySelector(".card__like-button"),this._likeStatus&&this._likeIcon.classList.add("card__like-button_active"),this._trashIcon=this._cardElement.querySelector(".card__trash-button"),this._deleteModal=document.querySelector("modal__delete-modal_active"),this._setEventListeners(),this._element}},s=class{constructor(t,e){this._formSelector=t.formSelector,this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass,this._formEl=e,this._inputList=[...this._formEl.querySelectorAll(this._inputSelector)],this._submitButton=this._formEl.querySelector(this._submitButtonSelector)}_setEventListeners(){this._inputList.forEach((t=>{t.addEventListener("input",(()=>{this._inputEl=t,this._checkInputValidity(t),this._toggleButtonState()}))}))}_showInputError(){this._errorMessageEl=document.querySelector(`#${this._inputEl.id}-error`),this._errorMessageEl.textContent=this._inputEl.validationMessage,this._inputEl.classList.add(this._inputErrorClass),this._errorMessageEl.classList.add(this._errorClass)}_checkInputValidity(){if(!this._inputEl.validity.valid)return this._showInputError();this._hideInputError()}_hideInputError(){this._errorMessageEl=document.querySelector(`#${this._inputEl.id}-error`),this._errorMessageEl.textContent="",this._inputEl.classList.remove(this._inputErrorClass),this._errorMessageEl.classList.remove(this._errorClass)}_toggleButtonState(){this._hasInvalidInput(this._inputList)?this._enableButton(this._inactiveButtonClass):this._disableButton(this._inactiveButtonClass)}_hasInvalidInput(){return!this._inputList.every((t=>t.validity.valid))}_enableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_disableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}enableValidation(){this._formEl.addEventListener("submit",(t=>{t.preventDefault()})),this._setEventListeners()}resetValidation(){this._toggleButtonState(),this._inputList.forEach((t=>{this._inputEl=t,this._hideInputError()}))}};const i=document.querySelector("#profile-edit-button"),r=document.querySelector("#modal-name-input"),a=document.querySelector("#modal-about-input"),n=document.querySelector(".profile__image"),o=document.querySelector(".profile__avatar-edit"),l=document.querySelector("#card-add-button"),d=document.querySelector(".cards__list"),c=document.querySelector("#modal-del-btn");var h=class{constructor(t){let{popupSelector:e}=t;this._modalEl=document.querySelector(e)}open(){this._modalEl.classList.add("modal_opened"),document.addEventListener("keyup",this._handleEsc)}close(){this._modalEl.classList.remove("modal_opened"),document.removeEventListener("keyup",this._handleEsc)}_handleEsc=t=>{"Escape"===t.key&&this.close()};setEventListeners(){this._modalEl.addEventListener("mousedown",(t=>{t.target.classList.contains("modal_opened")&&this.close(),t.target.classList.contains("modal__close")&&this.close()}))}},u=class extends h{constructor(t,e){super({popupSelector:t}),this._popupForm=this._modalEl.querySelector(".modal__form"),this._submitButton=this._modalEl.querySelector(".modal__save-button"),this._handleFormSubmit=e,this._list=[...this._popupForm.querySelectorAll(".modal__input")]}open(){this._submitButton.textContent="Save",super.open()}close(){this._popupForm.reset(),super.close()}setLoading(t){t&&(this._submitButton.textContent="Saving...")}_getInputValues(){const t={};return this._list.forEach((e=>{t[e.name]=e.value})),t}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(()=>{this._handleFormSubmit(this._getInputValues())})),super.setEventListeners()}},_=class{constructor(t){this._name=document.querySelector(".profile__name"),this._name.textContent=t.name,this._about=document.querySelector(".profile__about"),this._about.textContent=t.about,this._avatar=document.querySelector(".profile__image"),this._avatar.src=t.avatar}getUserInfo(){return v.getUserData()}setUserAvatar(t){this._avatar.src=t}setUserInfo(t){let{name:e,about:s}=t;this._name.textContent=e,this._about.textContent=s,v.updateUserData({name:e,about:s})}},m=class{constructor(t,e){let{data:s,renderer:i}=t;this._items=s,this._renderer=i,this._container=e}renderItems(){this._items.forEach((t=>{this._renderer(t)}))}addItem(t){this._container.prepend(t)}};const p={};var E;E={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__save-button",inactiveButtonClass:"modal__button-disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__input-error_visible"},Array.from(document.querySelectorAll(E.formSelector)).forEach((t=>{const e=new s(E,t),i=t.getAttribute("name");p[i]=e,e.enableValidation()}));const v=new class{constructor(t){this._baseUrl=t.baseUrl,this._auth=t.authorization,this._id}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:{authorization:`${this._auth}`}}).then((t=>t.ok?t.json():Promise.reject(`Error: ${t.status}`)))}getUserData(){return fetch(`${this._baseUrl}/users/me`,{method:"GET",headers:{authorization:`${this._auth}`,"Content-Type":"application/json"}})}updateUserData(t){let{name:e,about:s}=t;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:{authorization:`${this._auth}`,"Content-Type":"application/json"},body:JSON.stringify({name:`${e}`,about:`${s}`})})}updateAvatar(t){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:{authorization:`${this._auth}`,"Content-Type":"application/json"},body:JSON.stringify({avatar:t})})}getCards(t){return fetch(`${this._baseUrl}/cards/${t}`,{method:"GET",headers:{authorization:`${this._auth}`}})}createCard(t){let{name:e,link:s}=t;return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:{authorization:`${this._auth}`,"Content-Type":"application/json"},body:JSON.stringify({name:`${e}`,link:`${s}`})})}deleteCard(t){return fetch(`${this._baseUrl}/cards/${t}`,{method:"DELETE",headers:{authorization:`${this._auth}`,"Content-Type":"application/json"}})}likeCard(t){return fetch(`${this._baseUrl}/cards/${t}/likes`,{method:"PUT",headers:{authorization:`${this._auth}`,"Content-Type":"application/json"},body:JSON.stringify({isLiked:!0})})}disLikeCard(t){return fetch(`${this._baseUrl}/cards/${t}/likes`,{method:"DELETE",headers:{authorization:`${this._auth}`,"Content-Type":"application/json"}})}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",authorization:"7dcd9a93-149c-4e56-87db-9285c9177a9e"});v.getUserData().then((t=>t.json())).then((t=>{f=t.avatar,S=new _(t)})),v.getInitialCards().then((t=>{L=new m({data:t,renderer:t=>{const e=b(t);L.addItem(e)}},d),L.renderItems()}));const b=t=>{const s=new e(t,"#card-template",(()=>{g.open(t)}),(()=>{I.open(s)}));return s.getView()};let L,S,f,y;const g=new class extends h{constructor(t){super({popupSelector:t}),this._popupImage=document.querySelector(".modal__picture-view"),this._popupTitle=document.querySelector(".modal__picture-heading")}open(t){let{name:e,link:s}=t;this._popupImage.src=s,this._popupImage.alt=e,this._popupTitle.textContent=e,super.open()}}("#card-picture-modal");g.setEventListeners();const C=new u("#profile-edit-modal",(function(t){S.setUserInfo(t),C.setLoading(!0),v.updateUserData(t).then((()=>C.close())).catch((t=>console.error(`${t}, Failed to update Avatar`))).finally((()=>C.setLoading(!1)))}));C.setEventListeners();const k=new u("#card-add-modal",(function(t){k.setLoading(!0),v.createCard(t).then((t=>{if(t.ok)return t.json()})).then((t=>{const e=b(t);L.addItem(e),k.close()})).catch((t=>console.error(`${t}, Failed to update Avatar`))).finally((()=>k.setLoading(!1)))}));k.setEventListeners();const I=new class extends h{constructor(t,e){super({popupSelector:t}),this._handleDeleteConfirmation=e}open(t){super.open(),this._cardId=t._id,this._card=t}setEventListeners(){c.addEventListener("click",(()=>{this._handleDeleteConfirmation(this._card,this._cardId),this.close()})),super.setEventListeners()}}("#modal-delete",(function(t,e){t.handleDeleteCard(e)}));I.setEventListeners();const $=new u("#modal-avatar",(function(t){$.setLoading(!0),v.updateAvatar(t.link).then((()=>{n.src=t.link,$.close()})).catch((t=>console.error(`${t}, Failed to update Avatar`))).finally((()=>$.setLoading(!1)))}));$.setEventListeners(),i.addEventListener("click",(()=>{p.profileForm.resetValidation(),y=S.getUserInfo().then((t=>t.json())).then((t=>{r.value=t.name,a.value=t.about})),C.open()})),l.addEventListener("click",(()=>{p.addCardForm.resetValidation(),k.open()})),o.addEventListener("click",(()=>{p.avatarUpdate.resetValidation(),$.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TUFBUXJILEVBQUtPLEtBQzlCbUYsRUFBa0IyQixNQUFRckgsRUFBS3dILEtBQUssSUFFeENnRSxFQUFhekosTUFBTSxJQUdyQjhELEVBQWMxRSxpQkFBaUIsU0FBUyxLQUN0Q3VILEVBQTRCLFlBQUVuRCxrQkFDOUJ3RyxFQUFhaEssTUFBTSxJQUdyQjZELEVBQW1CekUsaUJBQWlCLFNBQVMsS0FDM0N1SCxFQUE2QixhQUFFbkQsa0JBQy9CZ0gsRUFBWXhLLE1BQU0sRyIsInNvdXJjZXMiOlsid2VicGFjazovL3ByYWN0aWN1bS93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9wcmFjdGljdW0vd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL3ByYWN0aWN1bS93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvdXRpbHMvdXRpbHMuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBDb25maXJtYXRpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVGhlIHJlcXVpcmUgc2NvcGVcbnZhciBfX3dlYnBhY2tfcmVxdWlyZV9fID0ge307XG5cbiIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIGRlZmluaXRpb24pIHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqLCBwcm9wKSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKTsgfSIsImltcG9ydCB7IGFwaSB9IGZyb20gXCIuLi9wYWdlcy9pbmRleC5qc1wiO1xyXG5pbXBvcnQgeyBkZWxldGVDb25maXJtUG9wdXAgfSBmcm9tIFwiLi4vcGFnZXMvaW5kZXguanNcIjtcclxuXHJcbmNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgZGF0YSxcclxuICAgIGNhcmRTZWxlY3RvcixcclxuICAgIGhhbmRsZUltYWdlQ2xpY2ssXHJcbiAgICBoYW5kbGVEZWxldGVDbGljayxcclxuICAgIGhhbmRsZUxpa2VEaXNsaWtlQ2xpY2tcclxuICApIHtcclxuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xyXG4gICAgdGhpcy5faWQgPSBkYXRhLl9pZDtcclxuICAgIHRoaXMuX2xpa2VTdGF0dXMgPSBkYXRhLmlzTGlrZWQ7XHJcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gaGFuZGxlSW1hZ2VDbGljaztcclxuICAgIHRoaXMuX2hhbmRsZUxpa2VEaXNMaWtlID0gaGFuZGxlTGlrZURpc2xpa2VDbGljaztcclxuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrID0gaGFuZGxlRGVsZXRlQ2xpY2s7XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PlxyXG4gICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHRoaXMpXHJcbiAgICApO1xyXG5cclxuICAgIHRoaXMuX2xpa2VJY29uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLl9oYW5kbGVMaWtlSWNvbigpKTtcclxuXHJcbiAgICB0aGlzLl90cmFzaEljb24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sodGhpcy5faWQpO1xyXG4gICAgICAvLyB0aGlzLl9oYW5kbGVEZWxldGVDYXJkKCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVMaWtlSWNvbigpIHtcclxuICAgIHRoaXMuX2xpa2VJY29uLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgICBpZiAoIXRoaXMuX2xpa2VTdGF0dXMpIHtcclxuICAgICAgYXBpLmxpa2VDYXJkKHRoaXMuX2lkKTtcclxuICAgIH1cclxuICAgIGFwaS5kaXNMaWtlQ2FyZCh0aGlzLl9pZCk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlRGVsZXRlQ29uZmlybShpZCkge1xyXG4gICAgZGVsZXRlQ29uZmlybVBvcHVwLm9wZW4oaWQpO1xyXG4gIH1cclxuXHJcbiAgaGFuZGxlRGVsZXRlQ2FyZChjYXJkSWQpIHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgYXBpLmRlbGV0ZUNhcmQoY2FyZElkKTtcclxuICAgIC8vIHRoaXMuX2NhcmRFbGVtZW50ID0gbnVsbDtcclxuICB9XHJcblxyXG4gIC8vIF9oYW5kbGVEZWxldGVDYXJkKCkge1xyXG4gIC8vICAgLy8gd2UgY2FuIGRvIGFueSBhY3Rpb25zIGhlcmVcclxuICAvLyAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrKHRoaXMuX2lkKTtcclxuICAvLyB9XHJcblxyXG4gIF9nZXRUZW1wbGF0ZSgpIHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gZG9jdW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxyXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcclxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBnZXRWaWV3KCkge1xyXG4gICAgdGhpcy5fZWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XHJcbiAgICB0aGlzLl9jYXJkVGl0bGVFbGVtZW50ID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcclxuICAgIHRoaXMuX2NhcmRUaXRsZUVsZW1lbnQudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlRWxlbWVudCA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbGVtZW50LnNyYyA9IHRoaXMuX2xpbms7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbGVtZW50LmFsdCA9IHRoaXMuX25hbWU7XHJcbiAgICB0aGlzLl9saWtlSWNvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XHJcbiAgICBpZiAodGhpcy5fbGlrZVN0YXR1cylcclxuICAgICAgdGhpcy5fbGlrZUljb24uY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICAgIHRoaXMuX3RyYXNoSWNvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdHJhc2gtYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5fZGVsZXRlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwibW9kYWxfX2RlbGV0ZS1tb2RhbF9hY3RpdmVcIik7XHJcblxyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IENhcmQ7XHJcbiIsImNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWwpIHtcclxuICAgIHRoaXMuX2Zvcm1TZWxlY3RvciA9IHNldHRpbmdzLmZvcm1TZWxlY3RvcjtcclxuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBzZXR0aW5ncy5pbnB1dFNlbGVjdG9yO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcclxuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBzZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xyXG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IHNldHRpbmdzLmVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9mb3JtRWwgPSBmb3JtRWw7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBbLi4udGhpcy5fZm9ybUVsLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcildO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybUVsLnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWwpID0+IHtcclxuICAgICAgaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2lucHV0RWwgPSBpbnB1dEVsO1xyXG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKTtcclxuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yKCkge1xyXG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjJHt0aGlzLl9pbnB1dEVsLmlkfS1lcnJvcmApO1xyXG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWwudGV4dENvbnRlbnQgPSB0aGlzLl9pbnB1dEVsLnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgdGhpcy5faW5wdXRFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICB0aGlzLl9lcnJvck1lc3NhZ2VFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrSW5wdXRWYWxpZGl0eSgpIHtcclxuICAgIGlmICghdGhpcy5faW5wdXRFbC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5fc2hvd0lucHV0RXJyb3IoKTtcclxuICAgIH1cclxuICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKCk7XHJcbiAgfVxyXG5cclxuICBfaGlkZUlucHV0RXJyb3IoKSB7XHJcbiAgICB0aGlzLl9lcnJvck1lc3NhZ2VFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke3RoaXMuX2lucHV0RWwuaWR9LWVycm9yYCk7XHJcbiAgICB0aGlzLl9lcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICB0aGlzLl9pbnB1dEVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIHRoaXMuX2Vycm9yTWVzc2FnZUVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KHRoaXMuX2lucHV0TGlzdCkpIHtcclxuICAgICAgdGhpcy5fZW5hYmxlQnV0dG9uKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICB0aGlzLl9kaXNhYmxlQnV0dG9uKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcclxuICAgIHJldHVybiAhdGhpcy5faW5wdXRMaXN0LmV2ZXJ5KChpbnB1dEVsKSA9PiBpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKTtcclxuICB9XHJcblxyXG4gIF9lbmFibGVCdXR0b24oKSB7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgfVxyXG5cclxuICBfZGlzYWJsZUJ1dHRvbigpIHtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgfVxyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fZm9ybUVsLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuXHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xyXG4gICAgICB0aGlzLl9pbnB1dEVsID0gaW5wdXRFbDtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgRm9ybVZhbGlkYXRvcjtcclxuIiwiLy8gQ0FSRCBEQVRBXHJcblxyXG4vLyBleHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xyXG4vLyAgIHtcclxuLy8gICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXHJcbi8vICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QveW9zZW1pdGUuanBnXCIsXHJcbi8vICAgfSxcclxuLy8gICB7XHJcbi8vICAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXHJcbi8vICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFrZS1sb3Vpc2UuanBnXCIsXHJcbi8vICAgfSxcclxuLy8gICB7XHJcbi8vICAgICBuYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXHJcbi8vICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvYmFsZC1tb3VudGFpbnMuanBnXCIsXHJcbi8vICAgfSxcclxuLy8gICB7XHJcbi8vICAgICBuYW1lOiBcIkxhdGVtYXJcIixcclxuLy8gICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYXRlbWFyLmpwZ1wiLFxyXG4vLyAgIH0sXHJcbi8vICAge1xyXG4vLyAgICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcclxuLy8gICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC92YW5vaXNlLmpwZ1wiLFxyXG4vLyAgIH0sXHJcbi8vICAge1xyXG4vLyAgICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxyXG4vLyAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhZ28uanBnXCIsXHJcbi8vICAgfSxcclxuLy8gXTtcclxuXHJcbi8vIFBST0ZJTEUgRUxFTUVOVFNcclxuXHJcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1lZGl0LWJ1dHRvblwiKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVOYW1lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsLW5hbWUtaW5wdXRcIik7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlQWJvdXRJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWwtYWJvdXQtaW5wdXRcIik7XHJcbmV4cG9ydCBjb25zdCBhdmF0YXJQcm9maWxlSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2ltYWdlXCIpO1xyXG5leHBvcnQgY29uc3QgYXZhdGFyVXBkYXRlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIi5wcm9maWxlX19hdmF0YXItZWRpdFwiXHJcbik7XHJcblxyXG4vL0NBUkQgRUxFTUVOVFNcclxuXHJcbmV4cG9ydCBjb25zdCBjYXJkQWRkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLWFkZC1idXR0b25cIik7XHJcbmV4cG9ydCBjb25zdCBjYXJkTGlzdEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saXN0XCIpO1xyXG5leHBvcnQgY29uc3QgY2FyZERlbGV0ZUNvbmZpcm1CdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsLWRlbC1idG5cIik7XHJcblxyXG4vLyBTRUxFQ1RPUlNcclxuXHJcbmV4cG9ydCBjb25zdCBjb25maWcgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxyXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fc2F2ZS1idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19idXR0b24tZGlzYWJsZWRcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dC1lcnJvcl92aXNpYmxlXCIsXHJcbn07XHJcbiIsImNsYXNzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IgfSkge1xyXG4gICAgdGhpcy5fbW9kYWxFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBvcGVuKCkge1xyXG4gICAgdGhpcy5fbW9kYWxFbC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIHRoaXMuX2hhbmRsZUVzYyk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX21vZGFsRWwuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCB0aGlzLl9oYW5kbGVFc2MpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUVzYyA9IChlKSA9PiB7XHJcbiAgICBpZiAoZS5rZXkgPT09IFwiRXNjYXBlXCIpIHRoaXMuY2xvc2UoKTtcclxuICB9O1xyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX21vZGFsRWwuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoZSkgPT4ge1xyXG4gICAgICBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfb3BlbmVkXCIpKSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9fY2xvc2VcIikpIHtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgUG9wdXA7XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XHJcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9tb2RhbEVsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9tb2RhbEVsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3NhdmUtYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgICB0aGlzLl9saXN0ID0gWy4uLnRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19pbnB1dFwiKV07XHJcbiAgfVxyXG5cclxuICBvcGVuKCkge1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZlXCI7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3BvcHVwRm9ybS5yZXNldCgpO1xyXG4gICAgc3VwZXIuY2xvc2UoKTtcclxuICB9XHJcblxyXG4gIHNldExvYWRpbmcobG9hZGluZykge1xyXG4gICAgaWYgKGxvYWRpbmcpIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIGNvbnN0IGlucHV0RGF0YSA9IHt9O1xyXG4gICAgdGhpcy5fbGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBpbnB1dERhdGFbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBpbnB1dERhdGE7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICB9KTtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhGb3JtO1xyXG4iLCJpbXBvcnQgeyBhcGkgfSBmcm9tIFwiLi4vcGFnZXMvaW5kZXguanNcIjtcclxuXHJcbmNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3Rvcih1c2VyRGF0YSkge1xyXG4gICAgdGhpcy5fbmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fbmFtZVwiKTtcclxuICAgIHRoaXMuX25hbWUudGV4dENvbnRlbnQgPSB1c2VyRGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fYWJvdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2Fib3V0XCIpO1xyXG4gICAgdGhpcy5fYWJvdXQudGV4dENvbnRlbnQgPSB1c2VyRGF0YS5hYm91dDtcclxuICAgIHRoaXMuX2F2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9faW1hZ2VcIik7XHJcbiAgICB0aGlzLl9hdmF0YXIuc3JjID0gdXNlckRhdGEuYXZhdGFyO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gYXBpLmdldFVzZXJEYXRhKCk7XHJcbiAgfVxyXG5cclxuICBzZXRVc2VyQXZhdGFyKGxpbmspIHtcclxuICAgIHRoaXMuX2F2YXRhci5zcmMgPSBsaW5rO1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KSB7XHJcbiAgICB0aGlzLl9uYW1lLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIHRoaXMuX2Fib3V0LnRleHRDb250ZW50ID0gYWJvdXQ7XHJcbiAgICBhcGkudXBkYXRlVXNlckRhdGEoeyBuYW1lLCBhYm91dCB9KTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFVzZXJJbmZvO1xyXG4iLCJjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3Rvcih7IGRhdGEsIHJlbmRlcmVyIH0sIGNvbnRhaW5lcikge1xyXG4gICAgdGhpcy5faXRlbXMgPSBkYXRhO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGNvbnRhaW5lcjtcclxuICB9XHJcblxyXG4gIHJlbmRlckl0ZW1zKCkge1xyXG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFNlY3Rpb247XHJcbiIsImltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgUG9wdXBDb25maXJtYXRpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBDb25maXJtYXRpb24uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2VzIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xyXG5pbXBvcnQgXCIuLi9wYWdlcy9pbmRleC5jc3NcIjtcclxuaW1wb3J0IHtcclxuICBjYXJkQWRkQnV0dG9uLFxyXG4gIGF2YXRhclVwZGF0ZUJ1dHRvbixcclxuICBwcm9maWxlRWRpdEJ1dHRvbixcclxuICBwcm9maWxlTmFtZUlucHV0LFxyXG4gIHByb2ZpbGVBYm91dElucHV0LFxyXG4gIGNhcmRMaXN0RWxlbWVudCxcclxuICBjb25maWcsXHJcbiAgYXZhdGFyUHJvZmlsZUltYWdlLFxyXG59IGZyb20gXCIuLi91dGlscy91dGlscy5qc1wiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcblxyXG5jb25zdCBmb3JtVmFsaWRhdG9ycyA9IHt9O1xyXG5cclxuY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9IChjb25maWcpID0+IHtcclxuICBjb25zdCBmb3JtTGlzdCA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuZm9ybVNlbGVjdG9yKSk7XHJcbiAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsZW1lbnQpID0+IHtcclxuICAgIGNvbnN0IHZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgZm9ybUVsZW1lbnQpO1xyXG4gICAgY29uc3QgZm9ybU5hbWUgPSBmb3JtRWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpO1xyXG4gICAgZm9ybVZhbGlkYXRvcnNbZm9ybU5hbWVdID0gdmFsaWRhdG9yO1xyXG4gICAgdmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuICB9KTtcclxufTtcclxuXHJcbmVuYWJsZVZhbGlkYXRpb24oY29uZmlnKTtcclxuXHJcbi8vQVBJXHJcblxyXG5leHBvcnQgY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxyXG4gIGF1dGhvcml6YXRpb246IFwiN2RjZDlhOTMtMTQ5Yy00ZTU2LTg3ZGItOTI4NWM5MTc3YTllXCIsXHJcbn0pO1xyXG5cclxuYXBpXHJcbiAgLmdldFVzZXJEYXRhKClcclxuICAudGhlbigocmVzdWx0cykgPT4gcmVzdWx0cy5qc29uKCkpXHJcbiAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgIGRhdGE7XHJcbiAgICBjdXJyZW50QXZhdGFyID0gZGF0YS5hdmF0YXI7XHJcbiAgICBpbml0aWFsVXNlckRhdGEgPSBuZXcgVXNlckluZm8oZGF0YSk7XHJcbiAgfSk7XHJcblxyXG5hcGkuZ2V0SW5pdGlhbENhcmRzKCkudGhlbigoZGF0YSkgPT4ge1xyXG4gIGRhdGE7XHJcblxyXG4gIGNhcmRTZWN0aW9uID0gbmV3IFNlY3Rpb24oXHJcbiAgICB7XHJcbiAgICAgIGRhdGE6IGRhdGEsXHJcbiAgICAgIHJlbmRlcmVyOiAoZGF0YSkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChkYXRhKTtcclxuICAgICAgICBjYXJkU2VjdGlvbi5hZGRJdGVtKGNhcmRFbGVtZW50KTtcclxuICAgICAgfSxcclxuICAgIH0sXHJcbiAgICBjYXJkTGlzdEVsZW1lbnRcclxuICApO1xyXG4gIGNhcmRTZWN0aW9uLnJlbmRlckl0ZW1zKCk7XHJcbn0pO1xyXG5cclxuY29uc3QgY3JlYXRlQ2FyZCA9IChjYXJkSXRlbSkgPT4ge1xyXG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcclxuICAgIGNhcmRJdGVtLFxyXG4gICAgXCIjY2FyZC10ZW1wbGF0ZVwiLFxyXG4gICAgKCkgPT4ge1xyXG4gICAgICBpbWdQb3B1cC5vcGVuKGNhcmRJdGVtKTtcclxuICAgIH0sXHJcbiAgICAoKSA9PiB7XHJcbiAgICAgIGRlbGV0ZUNvbmZpcm1Qb3B1cC5vcGVuKGNhcmQpO1xyXG4gICAgfVxyXG4gICk7XHJcbiAgcmV0dXJuIGNhcmQuZ2V0VmlldygpO1xyXG59O1xyXG5cclxuLy9WQVJcclxuXHJcbmxldCBjYXJkU2VjdGlvbjtcclxubGV0IGluaXRpYWxVc2VyRGF0YTtcclxubGV0IGN1cnJlbnRBdmF0YXI7XHJcbmxldCBwcm9maWxlRGF0YTtcclxubGV0IG5ld0NhcmREYXRhO1xyXG5cclxuLy9Qb3B1cHNcclxuXHJcbmNvbnN0IGltZ1BvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlcyhcIiNjYXJkLXBpY3R1cmUtbW9kYWxcIik7XHJcbmltZ1BvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCBwcm9maWxlUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBcIiNwcm9maWxlLWVkaXQtbW9kYWxcIixcclxuICBoYW5kbGVQcm9maWxlVXBkYXRlXHJcbik7XHJcbnByb2ZpbGVQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuY29uc3QgbmV3Q2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjY2FyZC1hZGQtbW9kYWxcIiwgaGFuZGxlQWRkQ2FyZCk7XHJcbm5ld0NhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuZXhwb3J0IGNvbnN0IGRlbGV0ZUNvbmZpcm1Qb3B1cCA9IG5ldyBQb3B1cENvbmZpcm1hdGlvbihcclxuICBcIiNtb2RhbC1kZWxldGVcIixcclxuICBoYW5kbGVEZWxldGVDb25maXJtYXRpb25cclxuKTtcclxuZGVsZXRlQ29uZmlybVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCBhdmF0YXJQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI21vZGFsLWF2YXRhclwiLCBoYW5kbGVVcGRhdGVBdmF0YXIpO1xyXG5hdmF0YXJQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuLy9IQU5ETEVTXHJcblxyXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVDb25maXJtYXRpb24oY2FyZCwgaWQpIHtcclxuICBjYXJkLmhhbmRsZURlbGV0ZUNhcmQoaWQpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlVXBkYXRlKHVzZXJEYXRhKSB7XHJcbiAgaW5pdGlhbFVzZXJEYXRhLnNldFVzZXJJbmZvKHVzZXJEYXRhKTtcclxuICBwcm9maWxlUG9wdXAuc2V0TG9hZGluZyh0cnVlKTtcclxuICBhcGlcclxuICAgIC51cGRhdGVVc2VyRGF0YSh1c2VyRGF0YSlcclxuICAgIC50aGVuKCgpID0+IHByb2ZpbGVQb3B1cC5jbG9zZSgpKVxyXG4gICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoYCR7ZXJyfSwgRmFpbGVkIHRvIHVwZGF0ZSBBdmF0YXJgKSlcclxuICAgIC5maW5hbGx5KCgpID0+IHByb2ZpbGVQb3B1cC5zZXRMb2FkaW5nKGZhbHNlKSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUFkZENhcmQoY2FyZERhdGEpIHtcclxuICBuZXdDYXJkUG9wdXAuc2V0TG9hZGluZyh0cnVlKTtcclxuICBhcGlcclxuICAgIC5jcmVhdGVDYXJkKGNhcmREYXRhKVxyXG4gICAgLnRoZW4oKHJlc3VsdCkgPT4ge1xyXG4gICAgICBpZiAocmVzdWx0Lm9rKSByZXR1cm4gcmVzdWx0Lmpzb24oKTtcclxuICAgIH0pXHJcbiAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAvLyBjb25zb2xlLmxvZyhgKipoYW5kbGVBZGRDYXJkKioke2RhdGF9YCk7XHJcbiAgICAgIGNvbnN0IGNhcmRGb3JtRWxlbWVudCA9IGNyZWF0ZUNhcmQoZGF0YSk7XHJcbiAgICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW0oY2FyZEZvcm1FbGVtZW50KTtcclxuXHJcbiAgICAgIC8vICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqIG5lZWQgdG8gcHVsbCBpZCBmcm9tIHNlcnZlciBub3cgb3IgYmVmb3JlIGxpa2UgYW5kIGRlbGV0ZVxyXG5cclxuICAgICAgbmV3Q2FyZFBvcHVwLmNsb3NlKCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoYCR7ZXJyfSwgRmFpbGVkIHRvIHVwZGF0ZSBBdmF0YXJgKSlcclxuICAgIC5maW5hbGx5KCgpID0+IG5ld0NhcmRQb3B1cC5zZXRMb2FkaW5nKGZhbHNlKSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZVVwZGF0ZUF2YXRhcihpbnB1dCkge1xyXG4gIGF2YXRhclBvcHVwLnNldExvYWRpbmcodHJ1ZSk7XHJcbiAgYXBpXHJcbiAgICAudXBkYXRlQXZhdGFyKGlucHV0LmxpbmspXHJcbiAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgIGF2YXRhclByb2ZpbGVJbWFnZS5zcmMgPSBpbnB1dC5saW5rO1xyXG4gICAgICBhdmF0YXJQb3B1cC5jbG9zZSgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKGAke2Vycn0sIEZhaWxlZCB0byB1cGRhdGUgQXZhdGFyYCkpXHJcbiAgICAuZmluYWxseSgoKSA9PiBhdmF0YXJQb3B1cC5zZXRMb2FkaW5nKGZhbHNlKSk7XHJcbn1cclxuXHJcbi8vRVZFTlQgTElTVEVORVJcclxuXHJcbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgZm9ybVZhbGlkYXRvcnNbXCJwcm9maWxlRm9ybVwiXS5yZXNldFZhbGlkYXRpb24oKTtcclxuICBwcm9maWxlRGF0YSA9IGluaXRpYWxVc2VyRGF0YVxyXG4gICAgLmdldFVzZXJJbmZvKClcclxuICAgIC50aGVuKChyZXN1bHRzKSA9PiByZXN1bHRzLmpzb24oKSlcclxuICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgIGRhdGE7XHJcblxyXG4gICAgICBwcm9maWxlTmFtZUlucHV0LnZhbHVlID0gZGF0YS5uYW1lO1xyXG4gICAgICBwcm9maWxlQWJvdXRJbnB1dC52YWx1ZSA9IGRhdGEuYWJvdXQ7XHJcbiAgICB9KTtcclxuICBwcm9maWxlUG9wdXAub3BlbigpO1xyXG59KTtcclxuXHJcbmNhcmRBZGRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBmb3JtVmFsaWRhdG9yc1tcImFkZENhcmRGb3JtXCJdLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIG5ld0NhcmRQb3B1cC5vcGVuKCk7XHJcbn0pO1xyXG5cclxuYXZhdGFyVXBkYXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgZm9ybVZhbGlkYXRvcnNbXCJhdmF0YXJVcGRhdGVcIl0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgYXZhdGFyUG9wdXAub3BlbigpO1xyXG59KTtcclxuIiwiY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XHJcbiAgICB0aGlzLl9iYXNlVXJsID0gb3B0aW9ucy5iYXNlVXJsO1xyXG4gICAgdGhpcy5fYXV0aCA9IG9wdGlvbnMuYXV0aG9yaXphdGlvbjtcclxuICAgIHRoaXMuX2lkO1xyXG4gIH1cclxuXHJcbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogYCR7dGhpcy5fYXV0aH1gLFxyXG4gICAgICB9LFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICB9KTtcclxuICB9XHJcbiAgLy9nZXRcclxuICBnZXRVc2VyRGF0YSgpIHtcclxuICAgIC8vZ2V0XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJHRVRcIixcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IGAke3RoaXMuX2F1dGh9YCxcclxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICAgICAgfSxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlVXNlckRhdGEoeyBuYW1lLCBhYm91dCB9KSB7XHJcbiAgICAvL3BhdGNoXHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogYCR7dGhpcy5fYXV0aH1gLFxyXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gICAgICB9LFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IG5hbWU6IGAke25hbWV9YCwgYWJvdXQ6IGAke2Fib3V0fWAgfSksXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZUF2YXRhcihsaW5rKSB7XHJcbiAgICAvL3BhdGNoXHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IGAke3RoaXMuX2F1dGh9YCxcclxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICAgICAgfSxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBhdmF0YXI6IGxpbmsgfSksXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGdldENhcmRzKGlkKSB7XHJcbiAgICAvL2dldFxyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7aWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiBgJHt0aGlzLl9hdXRofWAsXHJcbiAgICAgIH0sXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGNyZWF0ZUNhcmQoeyBuYW1lLCBsaW5rIH0pIHtcclxuICAgIC8vcG9zdFxyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogYCR7dGhpcy5fYXV0aH1gLFxyXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gICAgICB9LFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IG5hbWU6IGAke25hbWV9YCwgbGluazogYCR7bGlua31gIH0pLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBkZWxldGVDYXJkKGlkKSB7XHJcbiAgICAvL2RlbGV0ZVxyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7aWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiBgJHt0aGlzLl9hdXRofWAsXHJcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgIH0sXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGxpa2VDYXJkKGlkKSB7XHJcbiAgICAvL3B1dFxyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7aWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiBgJHt0aGlzLl9hdXRofWAsXHJcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgIH0sXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgaXNMaWtlZDogdHJ1ZSB9KSxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZGlzTGlrZUNhcmQoaWQpIHtcclxuICAgIC8vZGVsZXRlXHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtpZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IGAke3RoaXMuX2F1dGh9YCxcclxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICAgICAgfSxcclxuICAgICAgLy8gLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAvLyAgIGlmIChyZXMub2spIHtcclxuICAgICAgLy8gICAgIGNvbnN0IGlzTGlrZWQgPSBmYWxzZTtcclxuICAgICAgLy8gICB9XHJcbiAgICAgIC8vICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICAvLyB9KVxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBBcGk7XHJcblxyXG4vLyAudGhlbigocmVzKSA9PiB7XHJcbi8vICAgaWYgKHJlcy5vaykge1xyXG4vLyAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbi8vICAgfVxyXG4vLyAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuLy8gfSlcclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5jbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XHJcbiAgICB0aGlzLl9wb3B1cEltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fcGljdHVyZS12aWV3XCIpO1xyXG4gICAgdGhpcy5fcG9wdXBUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3BpY3R1cmUtaGVhZGluZ1wiKTtcclxuICB9XHJcblxyXG4gIG9wZW4oeyBuYW1lLCBsaW5rIH0pIHtcclxuICAgIHRoaXMuX3BvcHVwSW1hZ2Uuc3JjID0gbGluaztcclxuICAgIHRoaXMuX3BvcHVwSW1hZ2UuYWx0ID0gbmFtZTtcclxuICAgIHRoaXMuX3BvcHVwVGl0bGUudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgUG9wdXBXaXRoSW1hZ2U7XHJcbiIsImltcG9ydCB7IGNhcmREZWxldGVDb25maXJtQnV0dG9uIH0gZnJvbSBcIi4uL3V0aWxzL3V0aWxzLmpzXCI7XHJcbmltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuY2xhc3MgUG9wdXBDb25maXJtYXRpb24gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRGVsZXRlQ29uZmlybWF0aW9uKSB7XHJcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XHJcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDb25maXJtYXRpb24gPSBoYW5kbGVEZWxldGVDb25maXJtYXRpb247XHJcbiAgfVxyXG5cclxuICBvcGVuKGNhcmQpIHtcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICAgIHRoaXMuX2NhcmRJZCA9IGNhcmQuX2lkO1xyXG4gICAgdGhpcy5fY2FyZCA9IGNhcmQ7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIGNhcmREZWxldGVDb25maXJtQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNvbmZpcm1hdGlvbih0aGlzLl9jYXJkLCB0aGlzLl9jYXJkSWQpO1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9KTtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQb3B1cENvbmZpcm1hdGlvbjtcclxuIl0sIm5hbWVzIjpbIl9fd2VicGFja19yZXF1aXJlX18iLCJleHBvcnRzIiwiZGVmaW5pdGlvbiIsImtleSIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJvYmoiLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiY29uc3RydWN0b3IiLCJkYXRhIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlSW1hZ2VDbGljayIsImhhbmRsZURlbGV0ZUNsaWNrIiwiaGFuZGxlTGlrZURpc2xpa2VDbGljayIsInRoaXMiLCJfbmFtZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJfaWQiLCJfbGlrZVN0YXR1cyIsImlzTGlrZWQiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUltYWdlQ2xpY2siLCJfaGFuZGxlTGlrZURpc0xpa2UiLCJfaGFuZGxlRGVsZXRlQ2xpY2siLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfY2FyZEltYWdlRWxlbWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJfbGlrZUljb24iLCJfaGFuZGxlTGlrZUljb24iLCJfdHJhc2hJY29uIiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwiYXBpIiwibGlrZUNhcmQiLCJkaXNMaWtlQ2FyZCIsIl9oYW5kbGVEZWxldGVDb25maXJtIiwiaWQiLCJkZWxldGVDb25maXJtUG9wdXAiLCJvcGVuIiwiaGFuZGxlRGVsZXRlQ2FyZCIsImNhcmRJZCIsIl9jYXJkRWxlbWVudCIsInJlbW92ZSIsImRlbGV0ZUNhcmQiLCJfZ2V0VGVtcGxhdGUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiZ2V0VmlldyIsIl9lbGVtZW50IiwiX2NhcmRUaXRsZUVsZW1lbnQiLCJ0ZXh0Q29udGVudCIsInNyYyIsImFsdCIsImFkZCIsIl9kZWxldGVNb2RhbCIsInNldHRpbmdzIiwiZm9ybUVsIiwiX2Zvcm1TZWxlY3RvciIsImZvcm1TZWxlY3RvciIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9mb3JtRWwiLCJfaW5wdXRMaXN0IiwicXVlcnlTZWxlY3RvckFsbCIsIl9zdWJtaXRCdXR0b24iLCJmb3JFYWNoIiwiaW5wdXRFbCIsIl9pbnB1dEVsIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsIl90b2dnbGVCdXR0b25TdGF0ZSIsIl9zaG93SW5wdXRFcnJvciIsIl9lcnJvck1lc3NhZ2VFbCIsInZhbGlkYXRpb25NZXNzYWdlIiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oaWRlSW5wdXRFcnJvciIsIl9oYXNJbnZhbGlkSW5wdXQiLCJfZW5hYmxlQnV0dG9uIiwiX2Rpc2FibGVCdXR0b24iLCJldmVyeSIsImRpc2FibGVkIiwiZW5hYmxlVmFsaWRhdGlvbiIsImUiLCJwcmV2ZW50RGVmYXVsdCIsInJlc2V0VmFsaWRhdGlvbiIsInByb2ZpbGVFZGl0QnV0dG9uIiwicHJvZmlsZU5hbWVJbnB1dCIsInByb2ZpbGVBYm91dElucHV0IiwiYXZhdGFyUHJvZmlsZUltYWdlIiwiYXZhdGFyVXBkYXRlQnV0dG9uIiwiY2FyZEFkZEJ1dHRvbiIsImNhcmRMaXN0RWxlbWVudCIsImNhcmREZWxldGVDb25maXJtQnV0dG9uIiwiX3JlZiIsInBvcHVwU2VsZWN0b3IiLCJfbW9kYWxFbCIsIl9oYW5kbGVFc2MiLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsImNvbnRhaW5zIiwiUG9wdXAiLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfcG9wdXBGb3JtIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfbGlzdCIsInJlc2V0Iiwic2V0TG9hZGluZyIsImxvYWRpbmciLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dERhdGEiLCJpbnB1dCIsInZhbHVlIiwidXNlckRhdGEiLCJfYWJvdXQiLCJhYm91dCIsIl9hdmF0YXIiLCJhdmF0YXIiLCJnZXRVc2VySW5mbyIsImdldFVzZXJEYXRhIiwic2V0VXNlckF2YXRhciIsInNldFVzZXJJbmZvIiwidXBkYXRlVXNlckRhdGEiLCJjb250YWluZXIiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJdGVtcyIsIml0ZW0iLCJhZGRJdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJmb3JtVmFsaWRhdG9ycyIsImNvbmZpZyIsIkFycmF5IiwiZnJvbSIsImZvcm1FbGVtZW50IiwidmFsaWRhdG9yIiwiRm9ybVZhbGlkYXRvciIsImZvcm1OYW1lIiwiZ2V0QXR0cmlidXRlIiwib3B0aW9ucyIsIl9iYXNlVXJsIiwiYmFzZVVybCIsIl9hdXRoIiwiYXV0aG9yaXphdGlvbiIsImdldEluaXRpYWxDYXJkcyIsImZldGNoIiwiaGVhZGVycyIsInRoZW4iLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJ1cGRhdGVBdmF0YXIiLCJnZXRDYXJkcyIsImNyZWF0ZUNhcmQiLCJfcmVmMiIsInJlc3VsdHMiLCJjdXJyZW50QXZhdGFyIiwiaW5pdGlhbFVzZXJEYXRhIiwiVXNlckluZm8iLCJjYXJkU2VjdGlvbiIsIlNlY3Rpb24iLCJjYXJkRWxlbWVudCIsImNhcmRJdGVtIiwiY2FyZCIsIkNhcmQiLCJpbWdQb3B1cCIsInByb2ZpbGVEYXRhIiwiX3BvcHVwSW1hZ2UiLCJfcG9wdXBUaXRsZSIsInByb2ZpbGVQb3B1cCIsIlBvcHVwV2l0aEZvcm0iLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsImZpbmFsbHkiLCJuZXdDYXJkUG9wdXAiLCJjYXJkRGF0YSIsInJlc3VsdCIsImNhcmRGb3JtRWxlbWVudCIsImhhbmRsZURlbGV0ZUNvbmZpcm1hdGlvbiIsIl9oYW5kbGVEZWxldGVDb25maXJtYXRpb24iLCJfY2FyZElkIiwiX2NhcmQiLCJhdmF0YXJQb3B1cCJdLCJzb3VyY2VSb290IjoiIn0=