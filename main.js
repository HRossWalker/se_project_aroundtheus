!function(){"use strict";var t=class{constructor(t,e,s,i,r){this._name=t.name,this._link=t.link,this._id=t._id,this._likeStatus=t.isLiked,this._cardSelector=e,this._handleImageClick=s,this._handleDeleteClick=i,this._handleLikeDislike=r}_setEventListeners(){this._cardImageElement.addEventListener("click",(()=>this._handleImageClick(this))),this._likeIcon.addEventListener("click",(()=>this._handleLikeDislike(this._likeStatus,this._id))),this._trashIcon.addEventListener("click",(()=>{this._handleDeleteClick(this._id)}))}_handleLikeIcon(){this._likeIcon.classList.toggle("card__like-button_active")}handleDeleteCard(t){this._cardElement.remove()}_getTemplate(){return this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0),this._cardElement}getView(){return this._element=this._getTemplate(),this._cardTitleElement=this._cardElement.querySelector(".card__title"),this._cardTitleElement.textContent=this._name,this._cardImageElement=this._cardElement.querySelector(".card__image"),this._cardImageElement.src=this._link,this._cardImageElement.alt=this._name,this._likeIcon=this._cardElement.querySelector(".card__like-button"),this._likeStatus&&this._likeIcon.classList.add("card__like-button_active"),this._trashIcon=this._cardElement.querySelector(".card__trash-button"),this._deleteModal=document.querySelector("modal__delete-modal_active"),this._setEventListeners(),this._element}},e=class{constructor(t,e){this._formSelector=t.formSelector,this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass,this._formEl=e,this._inputList=[...this._formEl.querySelectorAll(this._inputSelector)],this._submitButton=this._formEl.querySelector(this._submitButtonSelector)}_setEventListeners(){this._inputList.forEach((t=>{t.addEventListener("input",(()=>{this._inputEl=t,this._checkInputValidity(t),this._toggleButtonState()}))}))}_showInputError(){this._errorMessageEl=document.querySelector(`#${this._inputEl.id}-error`),this._errorMessageEl.textContent=this._inputEl.validationMessage,this._inputEl.classList.add(this._inputErrorClass),this._errorMessageEl.classList.add(this._errorClass)}_checkInputValidity(){if(!this._inputEl.validity.valid)return this._showInputError();this._hideInputError()}_hideInputError(){this._errorMessageEl=document.querySelector(`#${this._inputEl.id}-error`),this._errorMessageEl.textContent="",this._inputEl.classList.remove(this._inputErrorClass),this._errorMessageEl.classList.remove(this._errorClass)}_toggleButtonState(){this._hasInvalidInput(this._inputList)?this._enableButton(this._inactiveButtonClass):this._disableButton(this._inactiveButtonClass)}_hasInvalidInput(){return!this._inputList.every((t=>t.validity.valid))}_enableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_disableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}enableValidation(){this._formEl.addEventListener("submit",(t=>{t.preventDefault()})),this._setEventListeners()}resetValidation(){this._toggleButtonState(),this._inputList.forEach((t=>{this._inputEl=t,this._hideInputError()}))}};const s=document.querySelector("#profile-edit-button"),i=document.querySelector("#modal-name-input"),r=document.querySelector("#modal-about-input"),a=document.querySelector(".profile__image"),n=document.querySelector(".profile__avatar-edit"),o=document.querySelector("#card-add-button"),l=document.querySelector(".cards__list"),c=document.querySelector("#modal-del-btn");var h=class{constructor(t){let{popupSelector:e}=t;this._modalEl=document.querySelector(e)}open(){this._modalEl.classList.add("modal_opened"),document.addEventListener("keyup",this._handleEsc)}close(){this._modalEl.classList.remove("modal_opened"),document.removeEventListener("keyup",this._handleEsc)}_handleEsc=t=>{"Escape"===t.key&&this.close()};setEventListeners(){this._modalEl.addEventListener("mousedown",(t=>{t.target.classList.contains("modal_opened")&&this.close(),t.target.classList.contains("modal__close")&&this.close()}))}},d=class extends h{constructor(t,e){super({popupSelector:t}),this._popupForm=this._modalEl.querySelector(".modal__form"),this._submitButton=this._modalEl.querySelector(".modal__save-button"),this._handleFormSubmit=e,this._list=[...this._popupForm.querySelectorAll(".modal__input")]}open(){this._submitButton.textContent="Save",super.open()}close(){this._popupForm.reset(),super.close()}setLoading(t){t&&(this._submitButton.textContent="Saving...")}_getInputValues(){const t={};return this._list.forEach((e=>{t[e.name]=e.value})),t}setEventListeners(){this._popupForm.addEventListener("submit",(()=>{this._handleFormSubmit(this._getInputValues())})),super.setEventListeners()}},u=class{constructor(t){this._name=document.querySelector(".profile__name"),this._name.textContent=t.name,this._about=document.querySelector(".profile__about"),this._about.textContent=t.about,this._avatar=document.querySelector(".profile__image"),this._avatar.src=t.avatar}setUserAvatar(t){this._avatar.src=t}setUserInfo(t){let{name:e,about:s}=t;this._name.textContent=e,this._about.textContent=s}},_=class{constructor(t,e){let{data:s,renderer:i}=t;this._items=s,this._renderer=i,this._container=e}renderItems(){this._items.forEach((t=>{this._renderer(t)}))}addItem(t){this._container.prepend(t)}};const m={};let p,E;var v;v={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__save-button",inactiveButtonClass:"modal__button-disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__input-error_visible"},Array.from(document.querySelectorAll(v.formSelector)).forEach((t=>{const s=new e(v,t),i=t.getAttribute("name");m[i]=s,s.enableValidation()}));const b=new class{constructor(t){this._baseUrl=t.baseUrl,this._auth=t.authorization,this._id}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:{authorization:`${this._auth}`}}).then((t=>this._checkResponse(t)))}getUserData(){return fetch(`${this._baseUrl}/users/me`,{method:"GET",headers:{authorization:`${this._auth}`,"Content-Type":"application/json"}}).then((t=>this._checkResponse(t)))}updateUserData(t){let{name:e,about:s}=t;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:{authorization:`${this._auth}`,"Content-Type":"application/json"},body:JSON.stringify({name:`${e}`,about:`${s}`})}).then((t=>this._checkResponse(t)))}updateAvatar(t){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:{authorization:`${this._auth}`,"Content-Type":"application/json"},body:JSON.stringify({avatar:t})}).then((t=>this._checkResponse(t)))}getCards(t){return fetch(`${this._baseUrl}/cards/${t}`,{method:"GET",headers:{authorization:`${this._auth}`}}).then((t=>this._checkResponse(t)))}createCard(t){let{name:e,link:s}=t;return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:{authorization:`${this._auth}`,"Content-Type":"application/json"},body:JSON.stringify({name:`${e}`,link:`${s}`})}).then((t=>this._checkResponse(t)))}deleteCard(t){return fetch(`${this._baseUrl}/cards/${t}`,{method:"DELETE",headers:{authorization:`${this._auth}`,"Content-Type":"application/json"}}).then((t=>this._checkResponse(t)))}likeCard(t){return fetch(`${this._baseUrl}/cards/${t}/likes`,{method:"PUT",headers:{authorization:`${this._auth}`,"Content-Type":"application/json"},body:JSON.stringify({isLiked:!0})}).then((t=>this._checkResponse(t)))}disLikeCard(t){return fetch(`${this._baseUrl}/cards/${t}/likes`,{method:"DELETE",headers:{authorization:`${this._auth}`,"Content-Type":"application/json"}}).then((t=>this._checkResponse(t)))}_checkResponse(t){return t.ok?t.json():Promise.reject(`Error: ${t.status}`)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",authorization:"7dcd9a93-149c-4e56-87db-9285c9177a9e"});b.getUserData().then((t=>{E=new u(t)})).catch((t=>console.error(`${t} Profile info may be incorrect`))),b.getInitialCards().then((t=>{p=new _({data:t,renderer:t=>{const e=k(t);p.addItem(e)}},l),p.renderItems()})).catch((t=>console.error(`${t} Cards may be missing`)));const k=e=>{const s=new t(e,"#card-template",(()=>{L.open(e)}),(()=>{C.open(s)}),((t,e)=>{t?b.disLikeCard(e).then((()=>s._handleLikeIcon())).catch((t=>console.error(`${t}, Failed to dislike card`))):b.likeCard(e).then((()=>s._handleLikeIcon())).catch((t=>console.error(`${t}, Failed to like card`)))}));return s.getView()},L=new class extends h{constructor(t){super({popupSelector:t}),this._popupImage=document.querySelector(".modal__picture-view"),this._popupTitle=document.querySelector(".modal__picture-heading")}open(t){let{name:e,link:s}=t;this._popupImage.src=s,this._popupImage.alt=e,this._popupTitle.textContent=e,super.open()}}("#card-picture-modal");L.setEventListeners();const S=new d("#profile-edit-modal",(function(t){S.setLoading(!0),b.updateUserData(t).then((()=>{E.setUserInfo(t),S.close()})).catch((t=>console.error(`${t}, Failed to update Avatar`))).finally((()=>S.setLoading(!1)))}));S.setEventListeners();const y=new d("#card-add-modal",(function(t){y.setLoading(!0),b.createCard(t).then((t=>{const e=k(t);p.addItem(e),y.close()})).catch((t=>console.error(`${t}, Failed to add Card`))).finally((()=>y.setLoading(!1)))}));y.setEventListeners();const C=new class extends h{constructor(t,e){super({popupSelector:t}),this._handleDeleteConfirmation=e}open(t){super.open(),this._cardId=t._id,this._card=t}setEventListeners(){c.addEventListener("click",(()=>{this._handleDeleteConfirmation(this._card,this._cardId),this.close()})),super.setEventListeners()}}("#modal-delete",(function(t,e){b.deleteCard(e).then((()=>t.handleDeleteCard(e))).catch((t=>console.error(`${t}, Failed to delete card`)))}));C.setEventListeners();const g=new d("#modal-avatar",(function(t){g.setLoading(!0),b.updateAvatar(t.link).then((()=>{a.src=t.link,g.close()})).catch((t=>console.error(`${t}, Failed to update Avatar`))).finally((()=>g.setLoading(!1)))}));g.setEventListeners(),s.addEventListener("click",(()=>{m.profileForm.resetValidation(),b.getUserData().then((t=>{i.value=t.name,r.value=t.about,S.open()})).catch((t=>console.error(`${t} Profile data may be incorrect`)))})),o.addEventListener("click",(()=>{m.addCardForm.resetValidation(),y.open()})),n.addEventListener("click",(()=>{m.avatarUpdate.resetValidation(),g.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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S0FDMUMrRyxFQUE0QixZQUFFbEQsa0JBQzlCNkQsRUFDR1ksY0FDQUgsTUFBTXRKLElBQ0xrRixFQUFpQjhCLE1BQVFoSCxFQUFLTyxLQUM5QjRFLEVBQWtCNkIsTUFBUWhILEVBQUttSCxNQUMvQnVFLEVBQWE5RixNQUFNLElBRXBCZ0YsT0FBT0MsR0FBUUMsUUFBUUMsTUFBTyxHQUFFRixvQ0FBcUMsSUFHMUV2RixFQUFjbkUsaUJBQWlCLFNBQVMsS0FDdEMrRyxFQUE0QixZQUFFbEQsa0JBQzlCNkcsRUFBYWpHLE1BQU0sSUFHckJQLEVBQW1CbEUsaUJBQWlCLFNBQVMsS0FDM0MrRyxFQUE2QixhQUFFbEQsa0JBQy9Cb0gsRUFBWXhHLE1BQU0sRyIsInNvdXJjZXMiOlsid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvdXRpbHMvdXRpbHMuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBDb25maXJtYXRpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgYXBpIH0gZnJvbSBcIi4uL3BhZ2VzL2luZGV4LmpzXCI7XHJcbmltcG9ydCB7IGRlbGV0ZUNvbmZpcm1Qb3B1cCB9IGZyb20gXCIuLi9wYWdlcy9pbmRleC5qc1wiO1xyXG5cclxuY2xhc3MgQ2FyZCB7XHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBkYXRhLFxyXG4gICAgY2FyZFNlbGVjdG9yLFxyXG4gICAgaGFuZGxlSW1hZ2VDbGljayxcclxuICAgIGhhbmRsZURlbGV0ZUNsaWNrLFxyXG4gICAgaGFuZGxlTGlrZURpc2xpa2VDbGlja1xyXG4gICkge1xyXG4gICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZTtcclxuICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XHJcbiAgICB0aGlzLl9pZCA9IGRhdGEuX2lkO1xyXG4gICAgdGhpcy5fbGlrZVN0YXR1cyA9IGRhdGEuaXNMaWtlZDtcclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xyXG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sgPSBoYW5kbGVEZWxldGVDbGljaztcclxuICAgIHRoaXMuX2hhbmRsZUxpa2VEaXNsaWtlID0gaGFuZGxlTGlrZURpc2xpa2VDbGljaztcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2NhcmRJbWFnZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XHJcbiAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sodGhpcylcclxuICAgICk7XHJcblxyXG4gICAgdGhpcy5fbGlrZUljb24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XHJcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2VEaXNsaWtlKHRoaXMuX2xpa2VTdGF0dXMsIHRoaXMuX2lkKVxyXG4gICAgKTtcclxuXHJcbiAgICB0aGlzLl90cmFzaEljb24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sodGhpcy5faWQpO1xyXG4gICAgICAvLyB0aGlzLl9oYW5kbGVEZWxldGVDYXJkKCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVMaWtlSWNvbigpIHtcclxuICAgIHRoaXMuX2xpa2VJY29uLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgfVxyXG5cclxuICBoYW5kbGVEZWxldGVDYXJkKGNhcmRJZCkge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICAvLyB0aGlzLl9jYXJkRWxlbWVudCA9IG51bGw7XHJcbiAgfVxyXG5cclxuICBfZ2V0VGVtcGxhdGUoKSB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcclxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXHJcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgZ2V0VmlldygpIHtcclxuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgdGhpcy5fY2FyZFRpdGxlRWxlbWVudCA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XHJcbiAgICB0aGlzLl9jYXJkVGl0bGVFbGVtZW50LnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuICAgIHRoaXMuX2NhcmRJbWFnZUVsZW1lbnQgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlRWxlbWVudC5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlRWxlbWVudC5hbHQgPSB0aGlzLl9uYW1lO1xyXG4gICAgdGhpcy5fbGlrZUljb24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xyXG4gICAgaWYgKHRoaXMuX2xpa2VTdGF0dXMpXHJcbiAgICAgIHRoaXMuX2xpa2VJY29uLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgICB0aGlzLl90cmFzaEljb24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RyYXNoLWJ1dHRvblwiKTtcclxuICAgIHRoaXMuX2RlbGV0ZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIm1vZGFsX19kZWxldGUtbW9kYWxfYWN0aXZlXCIpO1xyXG5cclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBDYXJkO1xyXG4iLCJjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsKSB7XHJcbiAgICB0aGlzLl9mb3JtU2VsZWN0b3IgPSBzZXR0aW5ncy5mb3JtU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBzZXR0aW5ncy5lcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fZm9ybUVsID0gZm9ybUVsO1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gWy4uLnRoaXMuX2Zvcm1FbC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm1FbC5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsKSA9PiB7XHJcbiAgICAgIGlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9pbnB1dEVsID0gaW5wdXRFbDtcclxuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbCk7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIF9zaG93SW5wdXRFcnJvcigpIHtcclxuICAgIHRoaXMuX2Vycm9yTWVzc2FnZUVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgIyR7dGhpcy5faW5wdXRFbC5pZH0tZXJyb3JgKTtcclxuICAgIHRoaXMuX2Vycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gdGhpcy5faW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZTtcclxuICAgIHRoaXMuX2lucHV0RWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoKSB7XHJcbiAgICBpZiAoIXRoaXMuX2lucHV0RWwudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuX3Nob3dJbnB1dEVycm9yKCk7XHJcbiAgICB9XHJcbiAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcigpO1xyXG4gIH1cclxuXHJcbiAgX2hpZGVJbnB1dEVycm9yKCkge1xyXG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjJHt0aGlzLl9pbnB1dEVsLmlkfS1lcnJvcmApO1xyXG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWwudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgdGhpcy5faW5wdXRFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICB0aGlzLl9lcnJvck1lc3NhZ2VFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xyXG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCh0aGlzLl9pbnB1dExpc3QpKSB7XHJcbiAgICAgIHRoaXMuX2VuYWJsZUJ1dHRvbih0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgdGhpcy5fZGlzYWJsZUJ1dHRvbih0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XHJcbiAgICByZXR1cm4gIXRoaXMuX2lucHV0TGlzdC5ldmVyeSgoaW5wdXRFbCkgPT4gaW5wdXRFbC52YWxpZGl0eS52YWxpZCk7XHJcbiAgfVxyXG5cclxuICBfZW5hYmxlQnV0dG9uKCkge1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xyXG4gIH1cclxuXHJcbiAgX2Rpc2FibGVCdXR0b24oKSB7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX2Zvcm1FbC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcblxyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWwpID0+IHtcclxuICAgICAgdGhpcy5faW5wdXRFbCA9IGlucHV0RWw7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IEZvcm1WYWxpZGF0b3I7XHJcbiIsIi8vIENBUkQgREFUQVxyXG5cclxuLy8gZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcclxuLy8gICB7XHJcbi8vICAgICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxyXG4vLyAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3lvc2VtaXRlLmpwZ1wiLFxyXG4vLyAgIH0sXHJcbi8vICAge1xyXG4vLyAgICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxyXG4vLyAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xha2UtbG91aXNlLmpwZ1wiLFxyXG4vLyAgIH0sXHJcbi8vICAge1xyXG4vLyAgICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxyXG4vLyAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxyXG4vLyAgIH0sXHJcbi8vICAge1xyXG4vLyAgICAgbmFtZTogXCJMYXRlbWFyXCIsXHJcbi8vICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGF0ZW1hci5qcGdcIixcclxuLy8gICB9LFxyXG4vLyAgIHtcclxuLy8gICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXHJcbi8vICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvdmFub2lzZS5qcGdcIixcclxuLy8gICB9LFxyXG4vLyAgIHtcclxuLy8gICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcclxuLy8gICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWdvLmpwZ1wiLFxyXG4vLyAgIH0sXHJcbi8vIF07XHJcblxyXG4vLyBQUk9GSUxFIEVMRU1FTlRTXHJcblxyXG5leHBvcnQgY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1idXR0b25cIik7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlTmFtZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1uYW1lLWlucHV0XCIpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZUFib3V0SW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsLWFib3V0LWlucHV0XCIpO1xyXG5leHBvcnQgY29uc3QgYXZhdGFyUHJvZmlsZUltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19pbWFnZVwiKTtcclxuZXhwb3J0IGNvbnN0IGF2YXRhclVwZGF0ZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIucHJvZmlsZV9fYXZhdGFyLWVkaXRcIlxyXG4pO1xyXG5cclxuLy9DQVJEIEVMRU1FTlRTXHJcblxyXG5leHBvcnQgY29uc3QgY2FyZEFkZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC1hZGQtYnV0dG9uXCIpO1xyXG5leHBvcnQgY29uc3QgY2FyZExpc3RFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcclxuZXhwb3J0IGNvbnN0IGNhcmREZWxldGVDb25maXJtQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1kZWwtYnRuXCIpO1xyXG5cclxuLy8gU0VMRUNUT1JTXHJcblxyXG5leHBvcnQgY29uc3QgY29uZmlnID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX3NhdmUtYnV0dG9uXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fYnV0dG9uLWRpc2FibGVkXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXHJcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXQtZXJyb3JfdmlzaWJsZVwiLFxyXG59O1xyXG4iLCJjbGFzcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yIH0pIHtcclxuICAgIHRoaXMuX21vZGFsRWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgb3BlbigpIHtcclxuICAgIHRoaXMuX21vZGFsRWwuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCB0aGlzLl9oYW5kbGVFc2MpO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9tb2RhbEVsLmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgdGhpcy5faGFuZGxlRXNjKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVFc2MgPSAoZSkgPT4ge1xyXG4gICAgaWYgKGUua2V5ID09PSBcIkVzY2FwZVwiKSB0aGlzLmNsb3NlKCk7XHJcbiAgfTtcclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9tb2RhbEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGUpID0+IHtcclxuICAgICAgaWYgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX29wZW5lZFwiKSkge1xyXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgfVxyXG4gICAgICBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfX2Nsb3NlXCIpKSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFBvcHVwO1xyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xyXG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fbW9kYWxFbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fbW9kYWxFbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zYXZlLWJ1dHRvblwiKTtcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xyXG4gICAgdGhpcy5fbGlzdCA9IFsuLi50aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9faW5wdXRcIildO1xyXG4gIH1cclxuXHJcbiAgb3BlbigpIHtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2ZVwiO1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcclxuICAgIHN1cGVyLmNsb3NlKCk7XHJcbiAgfVxyXG5cclxuICBzZXRMb2FkaW5nKGxvYWRpbmcpIHtcclxuICAgIGlmIChsb2FkaW5nKSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICBjb25zdCBpbnB1dERhdGEgPSB7fTtcclxuICAgIHRoaXMuX2xpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgaW5wdXREYXRhW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gaW5wdXREYXRhO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICB9KTtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhGb3JtO1xyXG4iLCJjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IodXNlckRhdGEpIHtcclxuICAgIHRoaXMuX25hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX25hbWVcIik7XHJcbiAgICB0aGlzLl9uYW1lLnRleHRDb250ZW50ID0gdXNlckRhdGEubmFtZTtcclxuICAgIHRoaXMuX2Fib3V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hYm91dFwiKTtcclxuICAgIHRoaXMuX2Fib3V0LnRleHRDb250ZW50ID0gdXNlckRhdGEuYWJvdXQ7XHJcbiAgICB0aGlzLl9hdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2ltYWdlXCIpO1xyXG4gICAgdGhpcy5fYXZhdGFyLnNyYyA9IHVzZXJEYXRhLmF2YXRhcjtcclxuICB9XHJcblxyXG4gIHNldFVzZXJBdmF0YXIobGluaykge1xyXG4gICAgdGhpcy5fYXZhdGFyLnNyYyA9IGxpbms7XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyh7IG5hbWUsIGFib3V0IH0pIHtcclxuICAgIHRoaXMuX25hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgdGhpcy5fYWJvdXQudGV4dENvbnRlbnQgPSBhYm91dDtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFVzZXJJbmZvO1xyXG4iLCJjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3Rvcih7IGRhdGEsIHJlbmRlcmVyIH0sIGNvbnRhaW5lcikge1xyXG4gICAgdGhpcy5faXRlbXMgPSBkYXRhO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGNvbnRhaW5lcjtcclxuICB9XHJcblxyXG4gIHJlbmRlckl0ZW1zKCkge1xyXG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFNlY3Rpb247XHJcbiIsImltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgUG9wdXBDb25maXJtYXRpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBDb25maXJtYXRpb24uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2VzIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xyXG5pbXBvcnQgXCIuLi9wYWdlcy9pbmRleC5jc3NcIjtcclxuaW1wb3J0IHtcclxuICBjYXJkQWRkQnV0dG9uLFxyXG4gIGF2YXRhclVwZGF0ZUJ1dHRvbixcclxuICBwcm9maWxlRWRpdEJ1dHRvbixcclxuICBwcm9maWxlTmFtZUlucHV0LFxyXG4gIHByb2ZpbGVBYm91dElucHV0LFxyXG4gIGNhcmRMaXN0RWxlbWVudCxcclxuICBjb25maWcsXHJcbiAgYXZhdGFyUHJvZmlsZUltYWdlLFxyXG59IGZyb20gXCIuLi91dGlscy91dGlscy5qc1wiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcblxyXG5jb25zdCBmb3JtVmFsaWRhdG9ycyA9IHt9O1xyXG5cclxuY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9IChjb25maWcpID0+IHtcclxuICBjb25zdCBmb3JtTGlzdCA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuZm9ybVNlbGVjdG9yKSk7XHJcbiAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsZW1lbnQpID0+IHtcclxuICAgIGNvbnN0IHZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgZm9ybUVsZW1lbnQpO1xyXG4gICAgY29uc3QgZm9ybU5hbWUgPSBmb3JtRWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpO1xyXG4gICAgZm9ybVZhbGlkYXRvcnNbZm9ybU5hbWVdID0gdmFsaWRhdG9yO1xyXG4gICAgdmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuICB9KTtcclxufTtcclxuXHJcbmVuYWJsZVZhbGlkYXRpb24oY29uZmlnKTtcclxuXHJcbi8vVkFSXHJcblxyXG5sZXQgY2FyZFNlY3Rpb247XHJcbmxldCBpbml0aWFsVXNlckRhdGE7XHJcblxyXG4vL0FQSVxyXG5cclxuZXhwb3J0IGNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcclxuICBhdXRob3JpemF0aW9uOiBcIjdkY2Q5YTkzLTE0OWMtNGU1Ni04N2RiLTkyODVjOTE3N2E5ZVwiLFxyXG59KTtcclxuXHJcbmFwaVxyXG4gIC5nZXRVc2VyRGF0YSgpXHJcbiAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgIGluaXRpYWxVc2VyRGF0YSA9IG5ldyBVc2VySW5mbyhkYXRhKTtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKGAke2Vycn0gUHJvZmlsZSBpbmZvIG1heSBiZSBpbmNvcnJlY3RgKSk7XHJcblxyXG5hcGlcclxuICAuZ2V0SW5pdGlhbENhcmRzKClcclxuICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgZGF0YTtcclxuXHJcbiAgICBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxyXG4gICAgICB7XHJcbiAgICAgICAgZGF0YTogZGF0YSxcclxuICAgICAgICByZW5kZXJlcjogKGRhdGEpID0+IHtcclxuICAgICAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChkYXRhKTtcclxuICAgICAgICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW0oY2FyZEVsZW1lbnQpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgIH0sXHJcbiAgICAgIGNhcmRMaXN0RWxlbWVudFxyXG4gICAgKTtcclxuICAgIGNhcmRTZWN0aW9uLnJlbmRlckl0ZW1zKCk7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihgJHtlcnJ9IENhcmRzIG1heSBiZSBtaXNzaW5nYCkpO1xyXG5cclxuY29uc3QgY3JlYXRlQ2FyZCA9IChjYXJkSXRlbSkgPT4ge1xyXG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcclxuICAgIGNhcmRJdGVtLFxyXG4gICAgXCIjY2FyZC10ZW1wbGF0ZVwiLFxyXG4gICAgKCkgPT4ge1xyXG4gICAgICBpbWdQb3B1cC5vcGVuKGNhcmRJdGVtKTtcclxuICAgIH0sXHJcbiAgICAoKSA9PiB7XHJcbiAgICAgIGRlbGV0ZUNvbmZpcm1Qb3B1cC5vcGVuKGNhcmQpO1xyXG4gICAgfSxcclxuXHJcbiAgICAobGlrZVN0YXR1cywgaWQpID0+IHtcclxuICAgICAgaWYgKCFsaWtlU3RhdHVzKSB7XHJcbiAgICAgICAgYXBpXHJcbiAgICAgICAgICAubGlrZUNhcmQoaWQpXHJcbiAgICAgICAgICAudGhlbigoKSA9PiBjYXJkLl9oYW5kbGVMaWtlSWNvbigpKVxyXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoYCR7ZXJyfSwgRmFpbGVkIHRvIGxpa2UgY2FyZGApKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBhcGlcclxuICAgICAgICAgIC5kaXNMaWtlQ2FyZChpZClcclxuICAgICAgICAgIC50aGVuKCgpID0+IGNhcmQuX2hhbmRsZUxpa2VJY29uKCkpXHJcbiAgICAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihgJHtlcnJ9LCBGYWlsZWQgdG8gZGlzbGlrZSBjYXJkYCkpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgKTtcclxuICByZXR1cm4gY2FyZC5nZXRWaWV3KCk7XHJcbn07XHJcblxyXG4vL1BvcHVwc1xyXG5cclxuY29uc3QgaW1nUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2VzKFwiI2NhcmQtcGljdHVyZS1tb2RhbFwiKTtcclxuaW1nUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmNvbnN0IHByb2ZpbGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiLFxyXG4gIGhhbmRsZVByb2ZpbGVVcGRhdGVcclxuKTtcclxucHJvZmlsZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCBuZXdDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNjYXJkLWFkZC1tb2RhbFwiLCBoYW5kbGVBZGRDYXJkKTtcclxubmV3Q2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5leHBvcnQgY29uc3QgZGVsZXRlQ29uZmlybVBvcHVwID0gbmV3IFBvcHVwQ29uZmlybWF0aW9uKFxyXG4gIFwiI21vZGFsLWRlbGV0ZVwiLFxyXG4gIGhhbmRsZURlbGV0ZUNvbmZpcm1hdGlvblxyXG4pO1xyXG5kZWxldGVDb25maXJtUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmNvbnN0IGF2YXRhclBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjbW9kYWwtYXZhdGFyXCIsIGhhbmRsZVVwZGF0ZUF2YXRhcik7XHJcbmF2YXRhclBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vL0hBTkRMRVNcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZUNvbmZpcm1hdGlvbihjYXJkLCBpZCkge1xyXG4gIGFwaVxyXG4gICAgLmRlbGV0ZUNhcmQoaWQpXHJcbiAgICAudGhlbigoKSA9PiBjYXJkLmhhbmRsZURlbGV0ZUNhcmQoaWQpKVxyXG4gICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoYCR7ZXJyfSwgRmFpbGVkIHRvIGRlbGV0ZSBjYXJkYCkpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlVXBkYXRlKHVzZXJEYXRhKSB7XHJcbiAgcHJvZmlsZVBvcHVwLnNldExvYWRpbmcodHJ1ZSk7XHJcbiAgYXBpXHJcbiAgICAudXBkYXRlVXNlckRhdGEodXNlckRhdGEpXHJcbiAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgIGluaXRpYWxVc2VyRGF0YS5zZXRVc2VySW5mbyh1c2VyRGF0YSk7XHJcbiAgICAgIHByb2ZpbGVQb3B1cC5jbG9zZSgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKGAke2Vycn0sIEZhaWxlZCB0byB1cGRhdGUgQXZhdGFyYCkpXHJcbiAgICAuZmluYWxseSgoKSA9PiBwcm9maWxlUG9wdXAuc2V0TG9hZGluZyhmYWxzZSkpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVBZGRDYXJkKGNhcmREYXRhKSB7XHJcbiAgbmV3Q2FyZFBvcHVwLnNldExvYWRpbmcodHJ1ZSk7XHJcbiAgYXBpXHJcbiAgICAuY3JlYXRlQ2FyZChjYXJkRGF0YSlcclxuICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgIGNvbnN0IGNhcmRGb3JtRWxlbWVudCA9IGNyZWF0ZUNhcmQoZGF0YSk7XHJcbiAgICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW0oY2FyZEZvcm1FbGVtZW50KTtcclxuICAgICAgbmV3Q2FyZFBvcHVwLmNsb3NlKCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoYCR7ZXJyfSwgRmFpbGVkIHRvIGFkZCBDYXJkYCkpXHJcbiAgICAuZmluYWxseSgoKSA9PiBuZXdDYXJkUG9wdXAuc2V0TG9hZGluZyhmYWxzZSkpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVVcGRhdGVBdmF0YXIoaW5wdXQpIHtcclxuICBhdmF0YXJQb3B1cC5zZXRMb2FkaW5nKHRydWUpO1xyXG4gIGFwaVxyXG4gICAgLnVwZGF0ZUF2YXRhcihpbnB1dC5saW5rKVxyXG4gICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICBhdmF0YXJQcm9maWxlSW1hZ2Uuc3JjID0gaW5wdXQubGluaztcclxuICAgICAgYXZhdGFyUG9wdXAuY2xvc2UoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihgJHtlcnJ9LCBGYWlsZWQgdG8gdXBkYXRlIEF2YXRhcmApKVxyXG4gICAgLmZpbmFsbHkoKCkgPT4gYXZhdGFyUG9wdXAuc2V0TG9hZGluZyhmYWxzZSkpO1xyXG59XHJcblxyXG4vL0VWRU5UIExJU1RFTkVSXHJcblxyXG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGZvcm1WYWxpZGF0b3JzW1wicHJvZmlsZUZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgYXBpXHJcbiAgICAuZ2V0VXNlckRhdGEoKVxyXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgcHJvZmlsZU5hbWVJbnB1dC52YWx1ZSA9IGRhdGEubmFtZTtcclxuICAgICAgcHJvZmlsZUFib3V0SW5wdXQudmFsdWUgPSBkYXRhLmFib3V0O1xyXG4gICAgICBwcm9maWxlUG9wdXAub3BlbigpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKGAke2Vycn0gUHJvZmlsZSBkYXRhIG1heSBiZSBpbmNvcnJlY3RgKSk7XHJcbn0pO1xyXG5cclxuY2FyZEFkZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGZvcm1WYWxpZGF0b3JzW1wiYWRkQ2FyZEZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgbmV3Q2FyZFBvcHVwLm9wZW4oKTtcclxufSk7XHJcblxyXG5hdmF0YXJVcGRhdGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBmb3JtVmFsaWRhdG9yc1tcImF2YXRhclVwZGF0ZVwiXS5yZXNldFZhbGlkYXRpb24oKTtcclxuICBhdmF0YXJQb3B1cC5vcGVuKCk7XHJcbn0pO1xyXG4iLCJjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBvcHRpb25zLmJhc2VVcmw7XHJcbiAgICB0aGlzLl9hdXRoID0gb3B0aW9ucy5hdXRob3JpemF0aW9uO1xyXG4gICAgdGhpcy5faWQ7XHJcbiAgfVxyXG5cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiBgJHt0aGlzLl9hdXRofWAsXHJcbiAgICAgIH0sXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHRoaXMuX2NoZWNrUmVzcG9uc2UocmVzKSk7XHJcbiAgfVxyXG5cclxuICAvL2dldFxyXG4gIGdldFVzZXJEYXRhKCkge1xyXG4gICAgLy9nZXRcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkdFVFwiLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogYCR7dGhpcy5fYXV0aH1gLFxyXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gICAgICB9LFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB0aGlzLl9jaGVja1Jlc3BvbnNlKHJlcykpO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlVXNlckRhdGEoeyBuYW1lLCBhYm91dCB9KSB7XHJcbiAgICAvL3BhdGNoXHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogYCR7dGhpcy5fYXV0aH1gLFxyXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gICAgICB9LFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IG5hbWU6IGAke25hbWV9YCwgYWJvdXQ6IGAke2Fib3V0fWAgfSksXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHRoaXMuX2NoZWNrUmVzcG9uc2UocmVzKSk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVBdmF0YXIobGluaykge1xyXG4gICAgLy9wYXRjaFxyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiBgJHt0aGlzLl9hdXRofWAsXHJcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgIH0sXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgYXZhdGFyOiBsaW5rIH0pLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB0aGlzLl9jaGVja1Jlc3BvbnNlKHJlcykpO1xyXG4gIH1cclxuXHJcbiAgZ2V0Q2FyZHMoaWQpIHtcclxuICAgIC8vZ2V0XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtpZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogXCJHRVRcIixcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IGAke3RoaXMuX2F1dGh9YCxcclxuICAgICAgfSxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4gdGhpcy5fY2hlY2tSZXNwb25zZShyZXMpKTtcclxuICB9XHJcblxyXG4gIGNyZWF0ZUNhcmQoeyBuYW1lLCBsaW5rIH0pIHtcclxuICAgIC8vcG9zdFxyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogYCR7dGhpcy5fYXV0aH1gLFxyXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gICAgICB9LFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IG5hbWU6IGAke25hbWV9YCwgbGluazogYCR7bGlua31gIH0pLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB0aGlzLl9jaGVja1Jlc3BvbnNlKHJlcykpO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZChpZCkge1xyXG4gICAgLy9kZWxldGVcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2lkfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogYCR7dGhpcy5fYXV0aH1gLFxyXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gICAgICB9LFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB0aGlzLl9jaGVja1Jlc3BvbnNlKHJlcykpO1xyXG4gIH1cclxuXHJcbiAgbGlrZUNhcmQoaWQpIHtcclxuICAgIC8vcHV0XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtpZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IGAke3RoaXMuX2F1dGh9YCxcclxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICAgICAgfSxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBpc0xpa2VkOiB0cnVlIH0pLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB0aGlzLl9jaGVja1Jlc3BvbnNlKHJlcykpO1xyXG4gIH1cclxuXHJcbiAgZGlzTGlrZUNhcmQoaWQpIHtcclxuICAgIC8vZGVsZXRlXHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtpZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IGAke3RoaXMuX2F1dGh9YCxcclxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICAgICAgfSxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4gdGhpcy5fY2hlY2tSZXNwb25zZShyZXMpKTtcclxuICB9XHJcblxyXG4gIF9jaGVja1Jlc3BvbnNlKHJlcykge1xyXG4gICAgaWYgKHJlcy5vaykge1xyXG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgIH1cclxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IEFwaTtcclxuXHJcbi8vIC50aGVuKChyZXMpID0+IHtcclxuLy8gICBpZiAocmVzLm9rKSB7XHJcbi8vICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuLy8gICB9XHJcbi8vICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4vLyB9KVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcclxuICAgIHRoaXMuX3BvcHVwSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19waWN0dXJlLXZpZXdcIik7XHJcbiAgICB0aGlzLl9wb3B1cFRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fcGljdHVyZS1oZWFkaW5nXCIpO1xyXG4gIH1cclxuXHJcbiAgb3Blbih7IG5hbWUsIGxpbmsgfSkge1xyXG4gICAgdGhpcy5fcG9wdXBJbWFnZS5zcmMgPSBsaW5rO1xyXG4gICAgdGhpcy5fcG9wdXBJbWFnZS5hbHQgPSBuYW1lO1xyXG4gICAgdGhpcy5fcG9wdXBUaXRsZS50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhJbWFnZTtcclxuIiwiaW1wb3J0IHsgY2FyZERlbGV0ZUNvbmZpcm1CdXR0b24gfSBmcm9tIFwiLi4vdXRpbHMvdXRpbHMuanNcIjtcclxuaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5jbGFzcyBQb3B1cENvbmZpcm1hdGlvbiBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVEZWxldGVDb25maXJtYXRpb24pIHtcclxuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcclxuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNvbmZpcm1hdGlvbiA9IGhhbmRsZURlbGV0ZUNvbmZpcm1hdGlvbjtcclxuICB9XHJcblxyXG4gIG9wZW4oY2FyZCkge1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gICAgdGhpcy5fY2FyZElkID0gY2FyZC5faWQ7XHJcbiAgICB0aGlzLl9jYXJkID0gY2FyZDtcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgY2FyZERlbGV0ZUNvbmZpcm1CdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ29uZmlybWF0aW9uKHRoaXMuX2NhcmQsIHRoaXMuX2NhcmRJZCk7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH0pO1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFBvcHVwQ29uZmlybWF0aW9uO1xyXG4iXSwibmFtZXMiOlsiY29uc3RydWN0b3IiLCJkYXRhIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlSW1hZ2VDbGljayIsImhhbmRsZURlbGV0ZUNsaWNrIiwiaGFuZGxlTGlrZURpc2xpa2VDbGljayIsInRoaXMiLCJfbmFtZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJfaWQiLCJfbGlrZVN0YXR1cyIsImlzTGlrZWQiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUltYWdlQ2xpY2siLCJfaGFuZGxlRGVsZXRlQ2xpY2siLCJfaGFuZGxlTGlrZURpc2xpa2UiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfY2FyZEltYWdlRWxlbWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJfbGlrZUljb24iLCJfdHJhc2hJY29uIiwiX2hhbmRsZUxpa2VJY29uIiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwiaGFuZGxlRGVsZXRlQ2FyZCIsImNhcmRJZCIsIl9jYXJkRWxlbWVudCIsInJlbW92ZSIsIl9nZXRUZW1wbGF0ZSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJnZXRWaWV3IiwiX2VsZW1lbnQiLCJfY2FyZFRpdGxlRWxlbWVudCIsInRleHRDb250ZW50Iiwic3JjIiwiYWx0IiwiYWRkIiwiX2RlbGV0ZU1vZGFsIiwic2V0dGluZ3MiLCJmb3JtRWwiLCJfZm9ybVNlbGVjdG9yIiwiZm9ybVNlbGVjdG9yIiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2Zvcm1FbCIsIl9pbnB1dExpc3QiLCJxdWVyeVNlbGVjdG9yQWxsIiwiX3N1Ym1pdEJ1dHRvbiIsImZvckVhY2giLCJpbnB1dEVsIiwiX2lucHV0RWwiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiX3Nob3dJbnB1dEVycm9yIiwiX2Vycm9yTWVzc2FnZUVsIiwiaWQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJfaGFzSW52YWxpZElucHV0IiwiX2VuYWJsZUJ1dHRvbiIsIl9kaXNhYmxlQnV0dG9uIiwiZXZlcnkiLCJkaXNhYmxlZCIsImVuYWJsZVZhbGlkYXRpb24iLCJlIiwicHJldmVudERlZmF1bHQiLCJyZXNldFZhbGlkYXRpb24iLCJwcm9maWxlRWRpdEJ1dHRvbiIsInByb2ZpbGVOYW1lSW5wdXQiLCJwcm9maWxlQWJvdXRJbnB1dCIsImF2YXRhclByb2ZpbGVJbWFnZSIsImF2YXRhclVwZGF0ZUJ1dHRvbiIsImNhcmRBZGRCdXR0b24iLCJjYXJkTGlzdEVsZW1lbnQiLCJjYXJkRGVsZXRlQ29uZmlybUJ1dHRvbiIsIl9yZWYiLCJwb3B1cFNlbGVjdG9yIiwiX21vZGFsRWwiLCJvcGVuIiwiX2hhbmRsZUVzYyIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImtleSIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiY29udGFpbnMiLCJQb3B1cCIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9wb3B1cEZvcm0iLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9saXN0IiwicmVzZXQiLCJzZXRMb2FkaW5nIiwibG9hZGluZyIsIl9nZXRJbnB1dFZhbHVlcyIsImlucHV0RGF0YSIsImlucHV0IiwidmFsdWUiLCJ1c2VyRGF0YSIsIl9hYm91dCIsImFib3V0IiwiX2F2YXRhciIsImF2YXRhciIsInNldFVzZXJBdmF0YXIiLCJzZXRVc2VySW5mbyIsImNvbnRhaW5lciIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiaXRlbSIsImFkZEl0ZW0iLCJlbGVtZW50IiwicHJlcGVuZCIsImZvcm1WYWxpZGF0b3JzIiwiY2FyZFNlY3Rpb24iLCJpbml0aWFsVXNlckRhdGEiLCJjb25maWciLCJBcnJheSIsImZyb20iLCJmb3JtRWxlbWVudCIsInZhbGlkYXRvciIsIkZvcm1WYWxpZGF0b3IiLCJmb3JtTmFtZSIsImdldEF0dHJpYnV0ZSIsImFwaSIsIm9wdGlvbnMiLCJfYmFzZVVybCIsImJhc2VVcmwiLCJfYXV0aCIsImF1dGhvcml6YXRpb24iLCJnZXRJbml0aWFsQ2FyZHMiLCJmZXRjaCIsImhlYWRlcnMiLCJ0aGVuIiwicmVzIiwiX2NoZWNrUmVzcG9uc2UiLCJnZXRVc2VyRGF0YSIsIm1ldGhvZCIsInVwZGF0ZVVzZXJEYXRhIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJ1cGRhdGVBdmF0YXIiLCJnZXRDYXJkcyIsImNyZWF0ZUNhcmQiLCJfcmVmMiIsImRlbGV0ZUNhcmQiLCJsaWtlQ2FyZCIsImRpc0xpa2VDYXJkIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsIlVzZXJJbmZvIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwiZXJyb3IiLCJTZWN0aW9uIiwiY2FyZEVsZW1lbnQiLCJjYXJkSXRlbSIsImNhcmQiLCJDYXJkIiwiaW1nUG9wdXAiLCJkZWxldGVDb25maXJtUG9wdXAiLCJsaWtlU3RhdHVzIiwiX3BvcHVwSW1hZ2UiLCJfcG9wdXBUaXRsZSIsInByb2ZpbGVQb3B1cCIsIlBvcHVwV2l0aEZvcm0iLCJmaW5hbGx5IiwibmV3Q2FyZFBvcHVwIiwiY2FyZERhdGEiLCJjYXJkRm9ybUVsZW1lbnQiLCJoYW5kbGVEZWxldGVDb25maXJtYXRpb24iLCJfaGFuZGxlRGVsZXRlQ29uZmlybWF0aW9uIiwiX2NhcmRJZCIsIl9jYXJkIiwiYXZhdGFyUG9wdXAiXSwic291cmNlUm9vdCI6IiJ9